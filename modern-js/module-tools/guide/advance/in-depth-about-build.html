<!doctype html><html  lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title data-rh="true">深入理解构建 - Modern.js Module</title><meta data-rh="true" name="description" content="模块工程解决方案"/>
<script id="check-dark-light">
;(() => {
  const saved = localStorage.getItem('rspress-theme-appearance')
  const prefereDark = window.matchMedia('(prefers-color-scheme: dark)').matches
  if (!saved || saved === 'auto' ? prefereDark : saved === 'dark') {
    document.documentElement.classList.add('dark')
  }
})()
</script>
<link rel="icon" href="https://lf3-static.bytednsdoc.com/obj/eden-cn/zq-uylkvT/ljhwZthlaukjlkulzlp/logo-1x-0104.png"><script defer="defer">!function(){var s,t,a,e,c,n,i,r,o,j,f,d,u,l={},y={};function b(s){var t=y[s];if(void 0!==t)return t.exports;var a=y[s]={id:s,loaded:!1,exports:{}};return l[s](a,a.exports,b),a.loaded=!0,a.exports}b.m=l,b.es=function(s,t){return Object.keys(s).forEach((function(a){"default"!==a&&!Object.prototype.hasOwnProperty.call(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:function(){return s[a]}})})),s},s={11056:["2123"],11473:["9955"],11852:["2661"],13593:["3563"],14545:["5009"],15837:["11"],16638:["4518"],16804:["8647"],16843:["2398"],16951:["5744"],18053:["2799"],18179:["3382"],18824:["9733"],18827:["7245"],1890:["64"],20564:["9569"],21395:["8178"],22278:["1753"],23082:["9571"],2448:["1071"],24750:["7663"],28422:["4535"],2877:["5166"],30022:["9306"],30159:["824"],30329:["825"],30784:["6789"],30817:["4665"],31674:["3275"],32302:["7800"],32817:["2624"],3331:["9644"],33443:["4960"],33857:["1456"],33974:["2663"],3424:["7277"],3743:["9527"],39438:["5321"],42384:["445"],42710:["6400"],44131:["9635"],45109:["8608"],46004:["2706"],47208:["5746"],47590:["105"],51621:["908"],53330:["6106"],53818:["4650"],55702:["3003"],56890:["1467"],58345:["7521"],5937:["4488"],62980:["7562"],63697:["9557"],6378:["9372"],64674:["6997"],65474:["593"],67908:["8655"],68395:["5285"],6901:["5244"],69070:["7121"],6915:["8499"],69818:["408"],7058:["1531"],71051:["1310"],72295:["6448"],75151:["6175"],75332:["2132"],77405:["8156"],77786:["6728"],78432:["9683"],78955:["1825"],79845:["3203"],80175:["8484"],80336:["8727"],80421:["6621"],80931:["3053"],81170:["4012"],81184:["3435"],82841:["3422"],83633:["5145"],86283:["299"],86442:["3317"],89051:["8734"],93082:["6143"],94247:["717"],96432:["2977"],97431:["2350"],98137:["7724"],99081:["2236"]},b.el=function(t){var a=s[t];return void 0===a?Promise.resolve():a.length>1?Promise.all(a.map(b.e)):b.e(a[0])},b.f={},b.e=function(s){return Promise.all(Object.keys(b.f).reduce((function(t,a){return b.f[a](s,t),t}),[]))},b.p="/module-tools/",b.u=function(s){return{105:"static/js/async/105.2902839f.js",1071:"static/js/async/1071.d777f6a6.js",11:"static/js/async/11.74994973.js",1310:"static/js/async/1310.57cce283.js",1456:"static/js/async/1456.5f4d349d.js",1467:"static/js/async/1467.2d081381.js",1531:"static/js/async/1531.fa9992cf.js",1753:"static/js/async/1753.d343fd4c.js",1825:"static/js/async/1825.6db358ed.js",2123:"static/js/async/2123.b8972960.js",2132:"static/js/async/2132.d5566f87.js",2236:"static/js/async/2236.f91c5f86.js",2350:"static/js/async/2350.4cb7589c.js",2398:"static/js/async/2398.4fc98542.js",2624:"static/js/async/2624.90677870.js",2661:"static/js/async/2661.63030320.js",2663:"static/js/async/2663.97914b7c.js",2706:"static/js/async/2706.3887804b.js",2799:"static/js/async/2799.b7ab3b82.js",2977:"static/js/async/2977.67586934.js",299:"static/js/async/299.1e25af4e.js",3003:"static/js/async/3003.c9f27ffa.js",3053:"static/js/async/3053.c566b0dc.js",3203:"static/js/async/3203.c67d2aed.js",3275:"static/js/async/3275.e5114b06.js",3317:"static/js/async/3317.cbc9da49.js",3382:"static/js/async/3382.75abc492.js",3422:"static/js/async/3422.c7eae80c.js",3435:"static/js/async/3435.ce5ec3af.js",3563:"static/js/async/3563.7329c80c.js",4012:"static/js/async/4012.43ff85ce.js",408:"static/js/async/408.8daa8d1e.js",445:"static/js/async/445.6d4bcb65.js",4488:"static/js/async/4488.b97224a7.js",4518:"static/js/async/4518.fc396add.js",4535:"static/js/async/4535.84c9d3a0.js",4650:"static/js/async/4650.5ecd35bb.js",4665:"static/js/async/4665.166df813.js",4960:"static/js/async/4960.dc1dd13c.js",5009:"static/js/async/5009.44647370.js",5145:"static/js/async/5145.5fb81225.js",5166:"static/js/async/5166.cad829de.js",5244:"static/js/async/5244.c33f47f3.js",5285:"static/js/async/5285.514bb4b6.js",5321:"static/js/async/5321.0956cdda.js",5744:"static/js/async/5744.aa647cc9.js",5746:"static/js/async/5746.20d77a2e.js",593:"static/js/async/593.a79a0c1e.js",6106:"static/js/async/6106.e33a1b18.js",6143:"static/js/async/6143.8c2276d8.js",6175:"static/js/async/6175.f4fb4b1a.js",64:"static/js/async/64.2c66ebcb.js",6400:"static/js/async/6400.88012cd6.js",6448:"static/js/async/6448.ddcdcad9.js",6621:"static/js/async/6621.05683678.js",6728:"static/js/async/6728.27b22dba.js",6789:"static/js/async/6789.e75c6ba4.js",6997:"static/js/async/6997.ef73d059.js",7121:"static/js/async/7121.e5244bce.js",717:"static/js/async/717.50ab1821.js",7245:"static/js/async/7245.4d378eaf.js",7277:"static/js/async/7277.d69482b8.js",7521:"static/js/async/7521.3b96b0f5.js",7562:"static/js/async/7562.45c85a32.js",7663:"static/js/async/7663.aa117d59.js",7724:"static/js/async/7724.e30aa764.js",7800:"static/js/async/7800.3d17776a.js",8156:"static/js/async/8156.01b46b71.js",8178:"static/js/async/8178.df6a3f3a.js",824:"static/js/async/824.7f11b575.js",825:"static/js/async/825.cfac1794.js",8484:"static/js/async/8484.370c1ca1.js",8499:"static/js/async/8499.0961ad69.js",8608:"static/js/async/8608.e4092154.js",8647:"static/js/async/8647.641bf00d.js",8655:"static/js/async/8655.73fb0ee2.js",8727:"static/js/async/8727.a166e0b0.js",8734:"static/js/async/8734.93d2dc6e.js",908:"static/js/async/908.da634873.js",9306:"static/js/async/9306.8283bb60.js",9372:"static/js/async/9372.c985502e.js",9527:"static/js/async/9527.4427e1c4.js",9557:"static/js/async/9557.1dc75de0.js",9569:"static/js/async/9569.c72d067e.js",9571:"static/js/async/9571.d1d57657.js",9635:"static/js/async/9635.903b071a.js",9644:"static/js/async/9644.23b713a8.js",9683:"static/js/async/9683.d506b964.js",9733:"static/js/async/9733.2f37dfb5.js",9955:"static/js/async/9955.31a029ec.js"}[s]},b.k=function(s){return s+".css"},t={},b.l=function(s,a,e,c){if(t[s])t[s].push(a);else{if(void 0!==e)for(var n,i,r=document.getElementsByTagName("script"),o=0;o<r.length;o++){var j=r[o];if(j.getAttribute("src")==s){n=j;break}}!n&&(i=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,n.src=s),t[s]=[a];var f=function(a,e){n.onerror=n.onload=null,clearTimeout(d);var c=t[s];if(delete t[s],n.parentNode&&n.parentNode.removeChild(n),c&&c.forEach((function(s){return s(e)})),a)return a(e)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=f.bind(null,n.onerror),n.onload=f.bind(null,n.onload),i&&document.head.appendChild(n)}},b.o=function(s,t){return Object.prototype.hasOwnProperty.call(s,t)},a=[],b.O=function(s,t,e,c){if(!t){var n=1/0;for(j=0;j<a.length;j++){t=a[j][0],e=a[j][1],c=a[j][2];for(var i=!0,r=0;r<t.length;r++)n>=c&&Object.keys(b.O).every((function(s){return b.O[s](t[r])}))?t.splice(r--,1):(i=!1,c<n&&(n=c));if(i){a.splice(j--,1);var o=e()}}return o}c=c||0;for(var j=a.length;j>0&&a[j-1][2]>c;j--)a[j]=a[j-1];a[j]=[t,e,c]},b.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(s){if("object"==typeof window)return window}}(),b.d=function(s,t){for(var a in t)b.o(t,a)&&!b.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:t[a]})},b.r=function(s){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},b.n=function(s){return s&&s.__esModule?s.default:s},c=Object.getPrototypeOf?function(s){return Object.getPrototypeOf(s)}:function(s){return s.__proto__},b.t=function(s,t){if(1&t&&(s=this(s)),8&t||"object"==typeof s&&s&&(4&t&&s.__esModule||16&t&&"function"==typeof s.then))return s;var a=Object.create(null);b.r(a);var n={};e=e||[null,c({}),c([]),c(c)];for(var i=2&t&&s;"object"==typeof i&&!~e.indexOf(i);i=c(i))Object.getOwnPropertyNames(i).forEach((function(t){n[t]=function(){return s[t]}}));return n.default=function(){return s},b.d(a,n),a},b.nmd=function(s){return s.paths=[],!s.children&&(s.children=[]),s},n={"builder-runtime":0,"lib-lodash":0,"lib-polyfill":0,"lib-react":0,"lib-router":0,main:0},i="webpack",r="data-webpack-loading",o=function(s,t,a,e){var c,n,o="chunk-"+s;if(!e){for(var j=document.getElementsByTagName("link"),f=0;f<j.length;f++){var d=j[f],u=d.getAttribute("href")||d.href;if(u&&!u.startsWith(b.p)&&(u=b.p+(u.startsWith("/")?u.slice(1):u)),"stylesheet"==d.rel&&(u&&u.startsWith(t)||d.getAttribute("data-webpack")==i+":"+o)){c=d;break}}if(!a)return c}!c&&(n=!0,(c=document.createElement("link")).setAttribute("data-webpack",i+":"+o),c.setAttribute(r,1),c.rel="stylesheet",c.href=t);var l=function(s,t){if(c.onerror=c.onload=null,c.removeAttribute(r),clearTimeout(y),t&&"load"!=t.type&&c.parentNode.removeChild(c),a(t),s)return s(t)};if(c.getAttribute(r)){var y=setTimeout(l.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=l.bind(null,c.onerror),c.onload=l.bind(null,c.onload)}else l(void 0,{type:"load",target:c});return e?e.parentNode.insertBefore(c,e):n&&document.head.appendChild(c),c},b.f.css=function(s,t){var a=b.o(n,s)?n[s]:void 0;if(0!==a)if(a)t.push(a[2]);else if(["6124"].indexOf(s)>-1){var e=new Promise((function(t,e){a=n[s]=[t,e]}));t.push(a[2]=e);var c=b.p+b.k(s),i=Error();o(s,c,(function(t){if(b.o(n,s)&&(0!==(a=n[s])&&(n[s]=void 0),a))if("load"!==t.type){var e=t&&t.type,c=t&&t.target&&t.target.src;i.message="Loading css chunk "+s+" failed.\n("+e+": "+c+")",i.name="ChunkLoadError",i.type=e,i.request=c,a[1](i)}else a[0]()}))}else n[s]=0},(j=self.webpackChunk_modern_js_module_tools_docs=self.webpackChunk_modern_js_module_tools_docs||[]).push=function(s,t){var a=t[0];s&&s(t);for(var e=0;e<a.length;e++)void 0===n[a[e]]&&(n[a[e]]=0)}.bind(null,j.push.bind(j)),f={"builder-runtime":0},b.f.j=function(s,t){var a=b.o(f,s)?f[s]:void 0;if(0!==a)if(a)t.push(a[2]);else if(["105","1071","11","1310","1456","1467","1531","1753","1825","2123","2132","2236","2350","2398","2624","2661","2663","2706","2799","2977","299","3003","3053","3203","3275","3317","3382","3422","3435","3563","4012","408","445","4488","4518","4535","4650","4665","4960","5009","5145","5166","5244","5285","5321","5744","5746","593","6106","6124","6143","6175","64","6400","6448","6621","6728","6789","6997","7121","717","7245","7277","7521","7562","7663","7724","7800","8156","8178","824","825","8484","8499","8608","8647","8655","8727","8734","908","9306","9372","9527","9557","9569","9571","9635","9644","9683","9733","9955","lib-lodash","lib-polyfill","lib-react","lib-router","main"].indexOf(s)>-1){var e=new Promise((function(t,e){a=f[s]=[t,e]}));t.push(a[2]=e);var c=b.p+b.u(s),n=Error();b.l(c,(function(t){if(b.o(f,s)&&(0!==(a=f[s])&&(f[s]=void 0),a)){var e=t&&("load"===t.type?"missing":t.type),c=t&&t.target&&t.target.src;n.message="Loading chunk "+s+" failed.\n("+e+": "+c+")",n.name="ChunkLoadError",n.type=e,n.request=c,a[1](n)}}),"chunk-"+s,s)}else f[s]=0},b.O.j=function(s){return 0===f[s]},d=function(s,t){var a,e,c=t[0],n=t[1],i=t[2],r=0;if(c.some((function(s){return 0!==f[s]}))){for(a in n)b.o(n,a)&&(b.m[a]=n[a]);if(i)var o=i(b)}for(s&&s(t);r<c.length;r++)e=c[r],b.o(f,e)&&f[e]&&f[e][0](),f[e]=0;return b.O(o)},(u=self.webpackChunk_modern_js_module_tools_docs=self.webpackChunk_modern_js_module_tools_docs||[]).forEach(d.bind(null,0)),u.push=d.bind(null,u.push.bind(u))}()</script><script defer="defer" src="/module-tools/static/js/lib-polyfill.e3e8718c.js"></script><script defer="defer" src="/module-tools/static/js/lib-lodash.84f4a2a3.js"></script><script defer="defer" src="/module-tools/static/js/lib-router.a5ca7a96.js"></script><script defer="defer" src="/module-tools/static/js/lib-react.4ea2c643.js"></script><script defer="defer" src="/module-tools/static/js/6124.ab94e9a2.js"></script><script defer="defer" src="/module-tools/static/js/main.cc7ecef0.js"></script><link href="/module-tools/static/css/6124.21280a51.css" rel="stylesheet"></head><body ><div id="root"><div><header class="top-0 left-0 md:fixed w-full" style="z-index:var(--rp-z-index-nav);background:var(--rp-c-bg)"><div class="navContainer_47ac2 rspress-nav px-6"><div class="container_47ac2 flex justify-between items-center h-full"><div class="undefined"><a href="/module-tools/" class="flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60"><span>Modern.js Module</span></a></div><div class="undefined flex flex-1 justify-end items-center"><div class="rightNav_47ac2"><div class="flex sm:flex-1 items-center sm:pl-4 sm:pr-2"><div class="navSearchButton_f619e"><button><svg width="18" height="24" viewBox="0 0 32 32" hight="18"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9Z"></path></svg><p class="searchWord_f619e">Search Docs</p><div><span>⌘</span><span>K</span></div></button></div><div class="mobileNavSearchButton_f619e"><svg width="24" height="24" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9Z"></path></svg></div></div><div class="rspress-nav-menu menu h-14"><a class="link_b3367  cursor-pointer" target="" href="/module-tools/guide/intro/welcome.html"><div class="singleItem_47ac2 activeItem_47ac2 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">指南</div></a><a class="link_b3367  cursor-pointer" target="" href="/module-tools/api/index.html"><div class="singleItem_47ac2  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">API</div></a><a class="link_b3367  cursor-pointer" target="" href="/module-tools/plugins/guide/getting-started.html"><div class="singleItem_47ac2  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">插件</div></a><div class="mx-3 last:mr-0"><div class="relative flex-center h-14"><button class="nav-menu-group-button flex-center items-center font-medium text-sm text-text-1 hover:text-text-2 transition-colors duration-200"><span class="text-sm font-medium flex" style="margin-right:2px">v2.35.0</span><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></button><div class="nav-menu-group-content absolute mx-0.8 transition-opacity duration-300" style="opacity:0;visibility:hidden;right:0;top:52px"><div class="p-3 pr-2 w-full h-full max-h-100vh whitespace-nowrap" style="box-shadow:var(--rp-shadow-3);z-index:100;border:1px solid var(--rp-c-divider-light);border-radius:2rem;background:var(--rp-c-bg)"><div><div class="font-medium my-1"><a href="https://github.com/web-infra-dev/modern.js/tree/main/packages/solutions/module-tools/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="link_b3367 "><div class="rounded-2xl hover:bg-mute" style="padding:0.4rem 1.5rem 0.4rem 0.75rem"><div class="flex"><span>更新日志</span></div></div></a></div></div><div><div class="font-medium my-1"><a href="https://modernjs.dev/en/community/contributing-guide.html" target="_blank" rel="noopener noreferrer" class="link_b3367 "><div class="rounded-2xl hover:bg-mute" style="padding:0.4rem 1.5rem 0.4rem 0.75rem"><div class="flex"><span>贡献指南</span></div></div></a></div></div></div></div></div></div></div><div class="flex-center flex-row"><div class="translation menu-item_47ac2 flex text-sm font-bold items-center px-3 py-2"><div><div class="relative flex-center h-14"><button class="nav-menu-group-button flex-center items-center font-medium text-sm text-text-1 hover:text-text-2 transition-colors duration-200"><span class="text-sm font-medium flex" style="margin-right:2px"><svg width="18" height="18" viewBox="0 0 32 32" style="with:18px;height:18px"><path fill="currentColor" d="M27.85 29H30l-6-15h-2.35l-6 15h2.15l1.6-4h6.85zm-7.65-6 2.62-6.56L25.45 23zM18 7V5h-7V2H9v3H2v2h10.74a14.71 14.71 0 0 1-3.19 6.18A13.5 13.5 0 0 1 7.26 9h-2.1a16.47 16.47 0 0 0 3 5.58A16.84 16.84 0 0 1 3 18l.75 1.86A18.47 18.47 0 0 0 9.53 16a16.92 16.92 0 0 0 5.76 3.84L16 18a14.48 14.48 0 0 1-5.12-3.37A17.64 17.64 0 0 0 14.8 7z"></path></svg></span><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></button><div class="nav-menu-group-content absolute mx-0.8 transition-opacity duration-300" style="opacity:0;visibility:hidden;right:0;top:52px"><div class="p-3 pr-2 w-full h-full max-h-100vh whitespace-nowrap" style="box-shadow:var(--rp-shadow-3);z-index:100;border:1px solid var(--rp-c-divider-light);border-radius:2rem;background:var(--rp-c-bg)"><div><div class="rounded-2xl my-1 flex" style="padding:0.4rem 1.5rem 0.4rem 0.75rem"><span class="text-brand">简体中文</span></div></div><div><div class="font-medium my-1"><a class="link_b3367  cursor-pointer" target="" href="/module-tools/en/guide/advance/in-depth-about-build.html"><div class="rounded-2xl hover:bg-mute" style="padding:0.4rem 1.5rem 0.4rem 0.75rem"><div class="flex"><span>English</span></div></div></a></div></div></div></div></div></div></div><div class="mx-2"><div class="md:mr-2 rspress-nav-appearance"><div class="p-1 border border-solid border-gray-300 text-gray-400  cursor-pointer rounded-md hover:border-gray-600 hover:text-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200 transition-all duration-300"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zM12 4c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zM12 24c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zM5.6 6.6c-.3 0-.5-.1-.7-.3L3.5 4.9c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.1.2-.4.3-.7.3zM19.8 20.8c-.3 0-.5-.1-.7-.3l-1.4-1.4c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.2.2-.5.3-.7.3zM3 13H1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zM23 13h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zM4.2 20.8c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.4.3-.7.3zM18.4 6.6c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.5.3-.7.3z"></path></svg></div></div></div><div class="social-links menu-item_8cbd0 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/web-infra-dev/modern.js/tree/main/packages/solutions/module-tools" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_8cbd0"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a></div></div></div></div><div class="mobileNavMenu_47ac2"><div class="navScreen_8624f " id="navScreen"><div class="container_8624f"><div class="navMenu_8624f"><div class="navMenuItem_8624f w-full"><a class="link_b3367  cursor-pointer" target="" href="/module-tools/guide/intro/welcome.html"><div class="singleItem_47ac2 activeItem_47ac2 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">指南</div></a></div><div class="navMenuItem_8624f w-full"><a class="link_b3367  cursor-pointer" target="" href="/module-tools/api/index.html"><div class="singleItem_47ac2  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">API</div></a></div><div class="navMenuItem_8624f w-full"><a class="link_b3367  cursor-pointer" target="" href="/module-tools/plugins/guide/getting-started.html"><div class="singleItem_47ac2  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">插件</div></a></div><div class="navMenuItem_8624f w-full"><div class="mx-3 last:mr-0"><div class=" navScreenMenuGroup_de8a5 relative"><button class="button_de8a5"><span class="buttonSpan_de8a5">v2.35.0</span><svg width="1em" height="1em" viewBox="0 0 32 32" class=" down_de8a5 "><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></button><div><div class="items_de8a5"><div><div class="py-1 font-medium"><a href="https://github.com/web-infra-dev/modern.js/tree/main/packages/solutions/module-tools/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="link_b3367 "><div><div class="flex justify-center"><span>更新日志</span></div></div></a></div></div><div><div class="py-1 font-medium"><a href="https://modernjs.dev/en/community/contributing-guide.html" target="_blank" rel="noopener noreferrer" class="link_b3367 "><div><div class="flex justify-center"><span>贡献指南</span></div></div></a></div></div></div></div></div></div></div></div><div class="flex-center flex-col gap-2"><div class="mt-2 navAppearance_8624f flex justify-center"></div><div class="undefined flex text-sm font-bold justify-center"><div class="mx-1.5 my-1"><div class=" navScreenMenuGroup_de8a5 relative"><button class="button_de8a5"><span class="buttonSpan_de8a5"><svg width="18" height="18" viewBox="0 0 32 32" style="width:18px;height:18px"><path fill="currentColor" d="M27.85 29H30l-6-15h-2.35l-6 15h2.15l1.6-4h6.85zm-7.65-6 2.62-6.56L25.45 23zM18 7V5h-7V2H9v3H2v2h10.74a14.71 14.71 0 0 1-3.19 6.18A13.5 13.5 0 0 1 7.26 9h-2.1a16.47 16.47 0 0 0 3 5.58A16.84 16.84 0 0 1 3 18l.75 1.86A18.47 18.47 0 0 0 9.53 16a16.92 16.92 0 0 0 5.76 3.84L16 18a14.48 14.48 0 0 1-5.12-3.37A17.64 17.64 0 0 0 14.8 7z"></path></svg></span><svg width="1em" height="1em" viewBox="0 0 32 32" class=" down_de8a5 "><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></button><div><div class="items_de8a5"><div><div class="p-1"><span class="text-brand">简体中文</span></div></div><div><div class="py-1 font-medium"><a class="link_b3367  cursor-pointer" target="" href="/module-tools/en.html"><div><div class="flex justify-center"><span>English</span></div></div></a></div></div></div></div></div></div></div><div class="social-links menu-item_8cbd0 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/web-infra-dev/modern.js/tree/main/packages/solutions/module-tools" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_8cbd0"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a></div></div></div></div></div><button class=" navHamburger_2498a text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div></header><section><div class="docLayout_feeda pt-0"><div class="localNav_dce60"><button class="menu_dce60 flex-center"><div class="text-md mr-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h24v2H4zm0 18h24v2H4zm0-12h24v2H4zm0 6h24v2H4z"></path></svg></div><span class="text-sm">Menu</span></button></div><aside class="sidebar_74484 rspress-sidebar "><div class="mt-1 sidebarContent_74484"><div class="rspress-scrollbar" style="max-height:calc(100vh - var(--rp-nav-height) - 8px);overflow:scroll"><nav class="pb-2"><section class="mt-0.5 block" style="margin-left:0"><div class="flex justify-between items-center  menuItem_74484" style="border-radius:0 1rem 1rem 0;cursor:pointer"><h2 class="py-2.5 px-3 text-sm font-medium flex" style="color:var(--rp-c-text-1);font-size:14px;padding-left:24px;font-weight:bold">介绍</h2><div class="collapseContainer_74484 p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/intro/welcome.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">欢迎使用</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/intro/why-module-engineering-solution.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">为什么需要 Modern.js Module</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/intro/getting-started.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">快速开始</div></a></div></div></div></section><section class="mt-0.5 block" style="margin-left:0"><div class="flex justify-between items-center  menuItem_74484" style="border-radius:0 1rem 1rem 0;cursor:pointer"><h2 class="py-2.5 px-3 text-sm font-medium flex" style="color:var(--rp-c-text-1);font-size:14px;padding-left:24px;font-weight:bold">基础使用</h2><div class="collapseContainer_74484 p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/before-getting-started.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">开始之前</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/command-preview.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">CLI 命令</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/modify-output-product.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">修改输出产物</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/use-micro-generator.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">使用微生成器</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/using-storybook.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">使用 Storybook</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/test-your-project.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">测试项目</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/basic/publish-your-project.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">版本管理与发布</div></a></div></div></div></section><section class="mt-0.5 block" style="margin-left:0"><div class="flex justify-between items-center  menuItem_74484" style="border-radius:0 1rem 1rem 0;cursor:pointer"><h2 class="py-2.5 px-3 text-sm font-medium flex" style="color:var(--rp-c-text-1);font-size:14px;padding-left:24px;font-weight:bold">进阶指南</h2><div class="collapseContainer_74484 p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/advance/in-depth-about-build.html"><div class="menuItemActive_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0;color:var(--rp-c-brand)">深入理解构建</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/advance/in-depth-about-dev-command.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">深入理解 dev 命令</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/advance/copy.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">使用 Copy 工具</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/advance/external-dependency.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">处理三方依赖</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/advance/build-umd.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">构建 umd 产物</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/advance/asset.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">处理静态资源</div></a></div></div></div></section><section class="mt-0.5 block" style="margin-left:0"><div class="flex justify-between items-center  menuItem_74484" style="border-radius:0 1rem 1rem 0;cursor:pointer"><h2 class="py-2.5 px-3 text-sm font-medium flex" style="color:var(--rp-c-text-1);font-size:14px;padding-left:24px;font-weight:bold">最佳实践</h2><div class="collapseContainer_74484 p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/best-practices/components.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">开发组件</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/best-practices/use-tailwindcss.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">使用 Tailwind CSS</div></a></div></div></div></section><section class="mt-0.5 block" style="margin-left:0"><div class="flex justify-between items-center  menuItem_74484" style="border-radius:0 1rem 1rem 0;cursor:pointer"><h2 class="py-2.5 px-3 text-sm font-medium flex" style="color:var(--rp-c-text-1);font-size:14px;padding-left:24px;font-weight:bold">常见问题</h2><div class="collapseContainer_74484 p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/faq/build.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">构建相关问题</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/faq/storybook.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">Storybook 相关问题</div></a></div><div><a class="link_b3367 menuLink_74484 cursor-pointer" target="" href="/module-tools/guide/faq/test.html"><div class="menuItem_74484 mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 1rem 1rem 0">测试相关问题</div></a></div></div></div></section></nav></div></div></aside><div class="content_feeda rspress-doc-container flex flex-shrink-0"><div class="w-full"><div class="rspress-doc"><!--$--><h1 id="深入理解构建" class="text-3xl mb-10 leading-10 tracking-tight title_f1ea0">深入理解构建<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#深入理解构建">#</a></h1>
<p class="my-4 leading-7">在 &quot;基础使用&quot; 的部分，我们已经知道可以通过 <code>buildConfig</code> 配置对项目的输出产物进行修改。<code>buildConfig</code> 不仅描述了产物的一些特性，同时还为构建产物提供了一些功能。</p>
<div class="modern-directive tip"><div class="modern-directive-title">TIP</div><div class="modern-directive-content"><p class="my-4 leading-7">如果你还不了解 <code>buildConfig</code> 的作用，请先阅读 <a href="/module-tools/guide/basic/modify-output-product.html" class="link_f1ea0 undefined">修改输出产物</a>。
</p></div></div>
<p class="my-4 leading-7">而在本章里我们将要深入理解某些构建配置的作用以及了解执行 <code>modern build</code> 命令的时候发生了什么。</p>
<h2 id="buildconfig" class="mt-14 mb-6 text-2xl tracking-tight title_f1ea0">buildConfig<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#buildconfig">#</a></h2>
<h3 id="bundle--bundleless" class="mt-10 mb-2 leading-7 text-xl title_f1ea0"><code>bundle</code> / <code>bundleless</code><a class="link_f1ea0 header-anchor" aria-hidden="true" href="#bundle--bundleless">#</a></h3>
<p class="my-4 leading-7">那么首先我们来了解一下 bundle 和 bundleless。</p>
<p class="my-4 leading-7">所谓 bundle 是指对构建产物进行打包，构建产物可能是一个文件，也有可能是基于一定的<a href="https://esbuild.github.io/api/#splitting" target="_blank" rel="noopener noreferrer" class="link_f1ea0 undefined">代码拆分策略</a>得到的多个文件。</p>
<p class="my-4 leading-7">而 bundleless 则是指对每个源文件单独进行编译构建，但是并不将它们打包在一起。每一个产物文件都可以找到与之相对应的源码文件。<strong class="font-semibold">bundleless 构建的过程，也可以理解为仅对源文件进行代码转换的过程</strong>。</p>
<p class="my-4 leading-7">它们有各自的好处：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">bundle 可以减少构建产物的体积，也可以对依赖预打包，减小安装依赖的体积。提前对库进行打包，可以加快应用项目构建的速度。</li>
<li class="[&amp;:not(:first-child)]:mt-2">bundleless 则是可以保持原有的文件结构，更有利于调试和 tree shaking。</li>
</ul>
<div class="modern-directive warning"><div class="modern-directive-title">WARNING</div><div class="modern-directive-content"><p class="my-4 leading-7">bundleless 是单文件编译模式，因此对于类型的引用和导出你需要加上 <code>type</code> 字段， 例如 <code>import type { A } from &#x27;./types</code>
</p></div></div>
<p class="my-4 leading-7">在 <code>buildConfig</code> 中可以通过 <a href="/module-tools/api/config/build-config.html#buildtype" class="link_f1ea0 undefined"><code>buildConfig.buildType</code></a> 来指定当前构建任务是 bundle 还是 bundleless。</p>
<h3 id="input--sourcedir" class="mt-10 mb-2 leading-7 text-xl title_f1ea0"><code>input</code> / <code>sourceDir</code><a class="link_f1ea0 header-anchor" aria-hidden="true" href="#input--sourcedir">#</a></h3>
<p class="my-4 leading-7"><a href="/module-tools/api/config/build-config.html#input" class="link_f1ea0 undefined"><code>buildConfig.input</code></a> 用于指定读取源码的文件路径或者目录路径，其默认值在 bundle 和 bundleless 构建过程中有所不同：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">当 <code>buildType: &#x27;bundle&#x27;</code> 的时候，<code>input</code> 默认值为 <code>src/index.(j|t)sx?</code></li>
<li class="[&amp;:not(:first-child)]:mt-2">当 <code>buildType: &#x27;bundleless&#x27;</code> 的时候，<code>input</code> 默认值为 <code>[&#x27;src&#x27;]</code></li>
</ul>
<div class="modern-directive warning"><div class="modern-directive-title">WARNING</div><div class="modern-directive-content"><p class="my-4 leading-7">建议不要在 bundleless 构建过程中指定多个源码文件目录，这可能会导致产物里的相对路径不正确。</p></div></div>
<p class="my-4 leading-7">从默认值上我们可以知道：<strong class="font-semibold">bundle 构建一般可以指定文件路径作为构建的入口，而 bundleless 构建则更期望使用目录路径寻找源文件</strong>。</p>
<p class="my-4 leading-7"><a href="/module-tools/api/config/build-config.html#sourcedir" class="link_f1ea0 undefined"><code>sourceDir</code></a> 用于指定源码目录，它主要与以下两个内容有关系：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">类型文件生成</li>
<li class="[&amp;:not(:first-child)]:mt-2">指定构建过程中的 <a href="https://esbuild.github.io/api/#outbase" target="_blank" rel="noopener noreferrer" class="link_f1ea0 undefined"><code>outbase</code></a></li>
</ul>
<p class="my-4 leading-7">一般来说：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">在 bundleless 构建过程中，<code>sourceDir</code> 与 <code>input</code> 的值要保持一致，它们的默认值都是 <code>src</code></strong>。</li>
<li class="[&amp;:not(:first-child)]:mt-2">在 bundle 构建过程中，无需使用 <code>sourceDir</code>。</li>
</ul>
<h3 id="dts" class="mt-10 mb-2 leading-7 text-xl title_f1ea0">dts<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#dts">#</a></h3>
<p class="my-4 leading-7"><a href="/module-tools/api/config/build-config.html#dts" class="link_f1ea0 undefined"><code>buildConfig.dts</code></a> 配置主要用于类型文件的生成。</p>
<h4 id="关闭类型生成" class="mt-8 leading-6 text-base title_f1ea0">关闭类型生成<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#关闭类型生成">#</a></h4>
<p class="my-4 leading-7">默认情况下类型生成功能是开启的，如果需要关闭的话，可以按照如下配置：</p>
<div class="language-js"><div class="rspress-code-title">modern.config.ts</div><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">import</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> defineConfig </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-keyword)">from</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;@modern-js/module-tools&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">export</span><span> </span><span class="token" style="color:var(--code-token-keyword)">default</span><span> </span><span class="token" style="color:var(--code-token-function)">defineConfig</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildConfig</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token literal-property" style="color:var(--code-token-parameter)">dts</span><span class="token operator">:</span><span> </span><span class="token boolean">false</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<div class="modern-directive tip"><div class="modern-directive-title">TIP</div><div class="modern-directive-content"><p class="my-4 leading-7">关闭类型文件后，一般来说构建速度会有所提升。</p></div></div>
<h4 id="打包类型文件" class="mt-8 leading-6 text-base title_f1ea0">打包类型文件<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#打包类型文件">#</a></h4>
<p class="my-4 leading-7">在 <code>buildType: &#x27;bundleless&#x27;</code> 的时候，类型文件的生成是使用项目的 <code>tsc</code> 命令来完成生产。</p>
<p class="my-4 leading-7"><strong class="font-semibold">Modern.js Module 同时还支持对类型文件进行打包</strong>，不过使用该功能的时候需要注意：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">一些第三方依赖存在错误的语法会导致打包过程失败。因此对于这种情况，需要手动通过 <a href="/module-tools/api/config/build-config.html#externals" class="link_f1ea0 undefined"><code>buildConfig.externals</code></a> 将这类第三方包排除。</li>
<li class="[&amp;:not(:first-child)]:mt-2">对于第三方依赖的类型文件指向的是一个 <code>.ts</code> 文件的情况，目前无法处理。比如第三方依赖的 <code>package.json</code> 中存在这样的内容： <code>{&quot;types&quot;: &quot;./src/index.ts&quot;}</code>。</li>
</ul>
<h4 id="别名转换" class="mt-8 leading-6 text-base title_f1ea0">别名转换<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#别名转换">#</a></h4>
<p class="my-4 leading-7">在 bundleless 构建过程中，如果源代码中出现了别名，例如：</p>
<div class="language-js"><div class="rspress-code-title">./src/index.ts</div><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">import</span><span> utils </span><span class="token" style="color:var(--code-token-keyword)">from</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;@common/utils&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">正常来说，使用 <code>tsc</code> 生成的产物类型文件也会包含这些别名。不过 Modern.js Module 会对 <code>tsc</code> 生成的类型文件里的别名进行转换处理：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">对于类似 <code>import &#x27;@common/utils&#x27;</code> 或者 <code>import utils from &#x27;@common/utils&#x27;</code> 这样形式的代码可以进行别名转换。</li>
<li class="[&amp;:not(:first-child)]:mt-2">对于类似 <code>export { utils } from &#x27;@common/utils&#x27;</code> 这样形式的代码可以进行别名转换。</li>
</ul>
<p class="my-4 leading-7">然而也存在一些情况，目前还无法处理，例如 <code>Promise&lt;import(&#x27;@common/utils&#x27;)&gt;</code> 这样形式的输出类型目前无法进行转换。
对于这种情况的解决办法，可以参与<a href="https://github.com/web-infra-dev/modern.js/discussions/4511" target="_blank" rel="noopener noreferrer" class="link_f1ea0 undefined">讨论</a>。</p>
<h4 id="一些示例" class="mt-8 leading-6 text-base title_f1ea0">一些示例<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#一些示例">#</a></h4>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">import</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> defineConfig </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-keyword)">from</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;@modern-js/module-tools&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">export</span><span> </span><span class="token" style="color:var(--code-token-keyword)">default</span><span> </span><span class="token" style="color:var(--code-token-function)">defineConfig</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-comment)">// 此时打包的类型文件输出路径为 `./dist/types`，并且将会读取项目下的 other-tsconfig.json 文件</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildConfig</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildType</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;bundle&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token literal-property" style="color:var(--code-token-parameter)">dts</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">tsconfigPath</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;./other-tsconfig.json&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">distPath</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;./types&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token literal-property" style="color:var(--code-token-parameter)">outDir</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;./dist&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">import</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> defineConfig </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-keyword)">from</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;@modern-js/module-tools&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">export</span><span> </span><span class="token" style="color:var(--code-token-keyword)">default</span><span> </span><span class="token" style="color:var(--code-token-function)">defineConfig</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-comment)">// 此时类型文件没有进行打包，输出路径为 `./dist/types`</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildConfig</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildType</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;bundle&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">dts</span><span class="token operator">:</span><span> </span><span class="token boolean">false</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">outDir</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;./dist&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildType</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;bundleless&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">dts</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token literal-property" style="color:var(--code-token-parameter)">only</span><span class="token operator">:</span><span> </span><span class="token boolean">true</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token literal-property" style="color:var(--code-token-parameter)">outDir</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;./dist/types&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<h3 id="define" class="mt-10 mb-2 leading-7 text-xl title_f1ea0"><code>define</code><a class="link_f1ea0 header-anchor" aria-hidden="true" href="#define">#</a></h3>
<p class="my-4 leading-7"><a href="/module-tools/api/config/build-config.html#define" class="link_f1ea0 undefined"><code>buildConfig.define</code></a> 功能有些类似 <a href="https://webpack.js.org/plugins/define-plugin/" target="_blank" rel="noopener noreferrer" class="link_f1ea0 undefined"><code>webpack.DefinePlugin</code></a>。这里介绍几个使用场景：</p>
<h4 id="环境变量替换" class="mt-8 leading-6 text-base title_f1ea0">环境变量替换<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#环境变量替换">#</a></h4>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">import</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> defineConfig </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-keyword)">from</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;@modern-js/module-tools&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">export</span><span> </span><span class="token" style="color:var(--code-token-keyword)">default</span><span> </span><span class="token" style="color:var(--code-token-function)">defineConfig</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildConfig</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token literal-property" style="color:var(--code-token-parameter)">define</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token string-property" style="color:var(--code-token-parameter)">&#x27;process.env.VERSION&#x27;</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-constant)">JSON</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">stringify</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>process</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>env</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-constant)">VERSION</span><span> </span><span class="token operator">||</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;0.0.0&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">通过上面的配置，我们就可以将下面这段代码：</p>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 编译前代码</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>console</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">log</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>process</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>env</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-constant)">VERSION</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">在执行 <code>VERSION=1.0.0 modern build</code> 的时候，转换为：</p>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 编译后代码</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>console</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">log</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;1.0.0&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<h4 id="全局变量替换" class="mt-8 leading-6 text-base title_f1ea0">全局变量替换<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#全局变量替换">#</a></h4>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">import</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> defineConfig </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-keyword)">from</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;@modern-js/module-tools&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">export</span><span> </span><span class="token" style="color:var(--code-token-keyword)">default</span><span> </span><span class="token" style="color:var(--code-token-function)">defineConfig</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token literal-property" style="color:var(--code-token-parameter)">buildConfig</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token literal-property" style="color:var(--code-token-parameter)">define</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-constant)">VERSION</span><span class="token operator">:</span><span> </span><span class="token" style="color:var(--code-token-constant)">JSON</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">stringify</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-function)">require</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;./package.json&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>version </span><span class="token operator">||</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;0.0.0&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">通过上面的配置，我们就可以将下面这段代码：</p>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 编译前代码</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>console</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">log</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-constant)">VERSION</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">转换为：</p>
<div class="language-js"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-comment)">// 编译后代码</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>console</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">log</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;1.0.0&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">不过要注意：如果项目是一个 TypeScript 项目，那么你可能需要在项目源代码目录下的 <code>.d.ts</code> 文件里增加以下内容：</p>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_f1ea0">
<p class="my-4 leading-7">如果不存在 <code>d.ts</code> 文件，则可以手动创建。</p>
</blockquote>
<div class="language-ts"><div class="rspress-code-title">env.d.ts</div><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-ts" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">declare</span><span> </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-constant)">YOUR_ADD_GLOBAL_VAR</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre><button class="copy"></button></div></div>
<h2 id="构建过程" class="mt-14 mb-6 text-2xl tracking-tight title_f1ea0">构建过程<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#构建过程">#</a></h2>
<p class="my-4 leading-7">当执行 <code>modern build</code> 命令的时候，会发生</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">根据 <code>buildConfig.outDir</code> 清理产物目录。</li>
<li class="[&amp;:not(:first-child)]:mt-2">编译 <code>js/ts</code> 源代码生成 bundle / bundleless 的 JS 构建产物。</li>
<li class="[&amp;:not(:first-child)]:mt-2">使用 <code>tsc</code> 生成 bundle / bundleless 的类型文件。</li>
<li class="[&amp;:not(:first-child)]:mt-2">处理 <code>copy</code> 任务。</li>
</ul>
<h2 id="构建报错" class="mt-14 mb-6 text-2xl tracking-tight title_f1ea0">构建报错<a class="link_f1ea0 header-anchor" aria-hidden="true" href="#构建报错">#</a></h2>
<p class="my-4 leading-7">当发生构建报错的时候，基于以上了解到的信息，可以很容易的明白在终端出现的报错内容：</p>
<p class="my-4 leading-7"><strong class="font-semibold">js 或者 ts 构建的报错：</strong></p>
<div class="language-bash"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>error  ModuleBuildError:
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">╭───────────────────────╮
</span><span style="display:block;padding:0 1.25rem">│ bundle failed:        │
</span><span style="display:block;padding:0 1.25rem"><span>│  - </span><span class="token" style="color:var(--code-token-function)">format</span><span> is </span><span class="token" style="color:var(--code-token-string)">&quot;cjs&quot;</span><span>    │
</span></span><span style="display:block;padding:0 1.25rem"><span>│  - target is </span><span class="token" style="color:var(--code-token-string)">&quot;esnext&quot;</span><span> │
</span></span><span style="display:block;padding:0 1.25rem">╰───────────────────────╯
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">Detailed Information:</span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7"><strong class="font-semibold">类型文件生成过程的报错：</strong></p>
<div class="language-bash"><div class="rspress-code-content"><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>error   ModuleBuildError:
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">bundle DTS failed:</span></code></pre><button class="copy"></button></div></div>
<p class="my-4 leading-7">对于 <code>js/ts</code> 构建错误，我们可以从报错信息中知道：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">报错的 <code>buildType</code></li>
<li class="[&amp;:not(:first-child)]:mt-2">报错的 <code>format</code></li>
<li class="[&amp;:not(:first-child)]:mt-2">报错的 <code>target</code></li>
<li class="[&amp;:not(:first-child)]:mt-2">其他具体报错信息</li>
</ul><!--/$--><div><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"></div><div class="flex flex-col"><a href="https://github.com/web-infra-dev/modern.js/tree/main/packages/document/module-doc/docs/zh/guide/advance/in-depth-about-build.md" target="_blank" class="editLink_eea9e">Edit this page on GitHub</a></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_33e00 flex flex-col"><a class="link_b3367 pager-link_33e00 cursor-pointer" target="" href="/module-tools/guide/basic/publish-your-project.html"><span class="desc_33e00">上一页</span><span class="title_33e00">版本管理与发布</span></a></div><div class="next_33e00 flex flex-col"><a class="link_b3367 pager-link_33e00 next_33e00 cursor-pointer" target="" href="/module-tools/guide/advance/in-depth-about-dev-command.html"><span class="desc_33e00">下一页</span><span class="title_33e00">深入理解 dev 命令</span></a></div></div></footer></div></div></div><div class="aside-container_feeda" style="max-height:calc(100vh - (var(--rp-nav-height) + 32px));overflow:scroll"><div><div class="flex flex-col"><div class="&lt;lg:hidden"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">目录</div><nav class="mt-1"><ul class="relative"><li><a href="#buildconfig" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">buildConfig</span></a></li><li><a href="#bundle--bundleless" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">bundle / bundleless</span></a></li><li><a href="#input--sourcedir" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">input / sourceDir</span></a></li><li><a href="#dts" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">dts</span></a></li><li><a href="#关闭类型生成" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">关闭类型生成</span></a></li><li><a href="#打包类型文件" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">打包类型文件</span></a></li><li><a href="#别名转换" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">别名转换</span></a></li><li><a href="#一些示例" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">一些示例</span></a></li><li><a href="#define" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">define</span></a></li><li><a href="#环境变量替换" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">环境变量替换</span></a></li><li><a href="#全局变量替换" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">全局变量替换</span></a></li><li><a href="#构建过程" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">构建过程</span></a></li><li><a href="#构建报错" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">构建报错</span></a></li></ul></nav></div></div></div></div></div></div></div></section></div></div><div id="search-container"></div></body></html>