(self.webpackChunk_modern_js_module_tools_docs=self.webpackChunk_modern_js_module_tools_docs||[]).push([["124"],{20838:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return c}});var i=l("9880"),d=l("23169");function s(e){let n=Object.assign({h1:"h1",a:"a",p:"p",strong:"strong",ul:"ul",li:"li",pre:"pre",code:"code",h2:"h2",h3:"h3"},(0,d.useMDXComponents)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h1,{id:"\u6784\u5EFA-umd-\u4EA7\u7269",children:["\u6784\u5EFA umd \u4EA7\u7269",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6784\u5EFA-umd-\u4EA7\u7269",children:"#"})]}),"\n",(0,i.jsxs)(n.p,{children:["umd \u5168\u79F0\u4E3A ",(0,i.jsx)(n.strong,{children:"Universal Module Definition"}),"\uFF0C\u8FD9\u79CD\u683C\u5F0F\u7684 JS \u6587\u4EF6\u53EF\u4EE5\u8FD0\u884C\u5728\u591A\u4E2A\u8FD0\u884C\u73AF\u5883\uFF1A"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6D4F\u89C8\u5668\u73AF\u5883\uFF1A\u57FA\u4E8E AMD \u89C4\u8303\u8FDB\u884C\u6A21\u5757\u52A0\u8F7D"}),"\n",(0,i.jsx)(n.li,{children:"Node.js \u73AF\u5883\uFF1A\u57FA\u4E8E CommonJS \u8FDB\u884C\u6A21\u5757\u52A0\u8F7D"}),"\n",(0,i.jsx)(n.li,{children:"\u5176\u4ED6\u60C5\u51B5\uFF1A\u5C06\u6A21\u5757\u6302\u8F7D\u5728\u5168\u5C40\u5BF9\u8C61\u4E0A\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u56E0\u6B64\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u4E0B\u9762\u7684\u65B9\u5F0F\uFF0C\u5C06\u9879\u76EE\u7684\u6784\u5EFA\u4EA7\u7269\u6307\u5B9A\u4E3A umd \u4EA7\u7269\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: {\n    format: 'umd',\n  },\n});\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"umd-\u4EA7\u7269\u7684\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5904\u7406",children:["umd \u4EA7\u7269\u7684\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5904\u7406",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#umd-\u4EA7\u7269\u7684\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5904\u7406",children:"#"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 ",(0,i.jsx)(n.a,{href:"/guide/advance/external-dependency",children:"\u300C\u5982\u4F55\u5904\u7406\u7B2C\u4E09\u65B9\u4F9D\u8D56\u300D"})," \u7AE0\u8282\u4E2D\uFF0C\u6211\u4EEC\u77E5\u9053\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.a,{href:"/api/config/build-config#autoexternal",children:(0,i.jsx)(n.code,{children:"autoExternals"})})," \u548C ",(0,i.jsx)(n.a,{href:"/api/config/build-config#externals",children:(0,i.jsx)(n.code,{children:"externals"})})," API \u6765\u63A7\u5236\u9879\u76EE\u662F\u5426\u5BF9\u7B2C\u4E09\u65B9\u4F9D\u8D56\u6253\u5305\u3002\n\u56E0\u6B64\u5728\u6784\u5EFA umd \u4EA7\u7269\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u8FD9\u6837\u4F7F\u7528\uFF1A"]}),"\n",(0,i.jsxs)(n.h3,{id:"\u793A\u4F8B",children:["\u793A\u4F8B",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u793A\u4F8B",children:"#"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5982\u679C\u9879\u76EE\u4F9D\u8D56\u4E86 ",(0,i.jsx)(n.code,{children:"react"}),"\uFF1A"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",meta:'title="package.json"',children:'{\n  "dependencies": {\n    "react": "^17"\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"modern.config.ts"})," \u914D\u7F6E\uFF1A"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",meta:'title="modern.config.ts"',children:"export default defineConfig({\n  buildConfig: {\n    format: 'umd',\n    autoExternal: false,\n    externals: ['react'],\n  },\n});\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5F53\u6E90\u7801\u4E2D\u4F7F\u7528\u4E86 ",(0,i.jsx)(n.code,{children:"react"})," \u4F9D\u8D56\uFF1A"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",meta:'title="src/index.ts"',children:"import React from 'react';\nconsole.info(React);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u6B64\u65F6\u4EA7\u7269\u4E2D\u4E0D\u4F1A\u5C06 ",(0,i.jsx)(n.code,{children:"react"})," \u4EE3\u7801\u6253\u5305\u5230\u4EA7\u7269\u4E2D\uFF1A"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",meta:'title="dist/index.js"',children:"(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object')\n    factory(exports, require('react'));\n  else if (typeof define === 'function' && define.amd)\n    define(['exports', 'react'], factory);\n  else if (\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\n  )\n    factory((global.index = {}), global.react);\n})(this, function (exports, _react) {\n  'use strict';\n  Object.defineProperty(exports, '__esModule', {\n    value: true,\n  });\n  _react = /*#__PURE__*/ _interopRequireDefault(_react);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj,\n        };\n  }\n  console.info(_react.default);\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u901A\u8FC7\u4E0A\u9762\u7684\u4F8B\u5B50\u6211\u4EEC\u77E5\u9053\uFF0C\u5F53\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"autoExternal"})," \u548C ",(0,i.jsx)(n.code,{children:"externals"})," API \u540E\uFF1A"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5728 Node.js \u73AF\u5883\u4E0B\uFF0C\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.code,{children:"require('react')"})," \u83B7\u53D6 react \u4F9D\u8D56\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5728 \u6D4F\u89C8\u5668\u73AF\u5883\u4E0B\uFF0C\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.code,{children:"global.react"})," \u83B7\u53D6 react \u4F9D\u8D56\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"\u4E09\u65B9\u4F9D\u8D56\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",children:["\u4E09\u65B9\u4F9D\u8D56\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4E09\u65B9\u4F9D\u8D56\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",children:"#"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u800C\u5728\u6D4F\u89C8\u5668\u73AF\u5883\u4E0B\uFF0C\u83B7\u53D6\u7B2C\u4E09\u65B9\u4F9D\u8D56\u7684\u65F6\u5019\uFF0C",(0,i.jsx)(n.strong,{children:"\u5168\u5C40\u53D8\u91CF\u540D\u79F0\u4E0D\u4E00\u5B9A\u4E0E\u4F9D\u8D56\u540D\u79F0\u5B8C\u5168\u76F8\u540C"}),"\uFF0C\u6B64\u65F6\u5C31\u8981\u4F7F\u7528 ",(0,i.jsx)(n.a,{href:"/api/config/build-config#umdglobals",children:(0,i.jsx)(n.code,{children:"buildConfig.umdGlobals"})})," API\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u8FD8\u662F\u4F7F\u7528\u4E4B\u524D\u7684\u4F8B\u5B50\uFF0C\u5F53 ",(0,i.jsx)(n.code,{children:"react"})," \u4F9D\u8D56\u4EE5 ",(0,i.jsx)(n.code,{children:"windows.React"})," \u6216\u8005 ",(0,i.jsx)(n.code,{children:"global.React"})," \u5168\u5C40\u53D8\u91CF\u7684\u5F62\u5F0F\u5B58\u5728\u4E8E\u6D4F\u89C8\u5668\u73AF\u5883\u4E0B\uFF0C\u90A3\u4E48\u6B64\u65F6\uFF1A"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"modern.config.ts"})," \u914D\u7F6E\uFF1A"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: {\n    format: 'umd',\n    umdGlobals: {\n      react: 'React',\n    },\n  },\n});\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5F53\u6E90\u7801\u4E2D\u4F7F\u7528\u4E86 ",(0,i.jsx)(n.code,{children:"react"})," \u4F9D\u8D56\uFF1A"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",meta:'title="src/index.ts"',children:"import React from 'react';\nconsole.info(React);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6B64\u65F6\u6211\u4EEC\u4F1A\u770B\u5230\u8FD9\u6837\u7684\u4EA7\u7269\u4EE3\u7801\uFF1A"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",meta:'title="dist/index.js"',children:"(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object')\n    factory();\n  else if (typeof define === 'function' && define.amd) define([], factory);\n  else if (\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\n  )\n    factory();\n})(this, function () {\n  // ...\n  // libuild:globals:react\n  var require_react = __commonJS({\n    'libuild:globals:react'(exports, module1) {\n      module1.exports = Function('return this')()['React'];\n    },\n  });\n  // src/index.ts\n  var import_react = __toESM(require_react());\n  console.info(import_react.default);\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u6B64\u65F6\u9879\u76EE\u5C31\u53EF\u4EE5\u8FD0\u884C\u5728\u6D4F\u89C8\u5668\u4E2D\uFF0C\u5E76\u4F7F\u7528\u5B58\u5728\u4E8E\u5168\u5C40\u5BF9\u8C61\u4E0A\u7684 ",(0,i.jsx)(n.code,{children:"React"})," \u53D8\u91CF\u4E86\u3002"]}),"\n",(0,i.jsxs)(n.h2,{id:"\u66F4\u6539\u9879\u76EE\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",children:["\u66F4\u6539\u9879\u76EE\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u66F4\u6539\u9879\u76EE\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",children:"#"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u5F53\u6211\u4EEC\u5C06\u4E0B\u9762\u7684\u4EE3\u7801\u6253\u5305\u6210 umd \u4EA7\u7269\u5E76\u8FD0\u884C\u5728\u6D4F\u89C8\u5668\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.code,{children:"window.index"})," \u6765\u4F7F\u7528\u8BE5\u6A21\u5757\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",meta:'title="./src/index.ts"',children:"export default () => {\n  console.info('hello world');\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u4EE5\u6E90\u7801\u6587\u4EF6\u540D\u79F0\u4F5C\u4E3A\u8BE5\u6A21\u5757\u5728\u6D4F\u89C8\u5668\u91CC\u5168\u5C40\u53D8\u91CF\u7684\u540D\u79F0"}),"\u3002\u5BF9\u4E8E\u4E0A\u9762\u7684\u4F8B\u5B50\uFF0C\u5176\u4EA7\u7269\u5185\u5BB9\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",meta:'title="./dist/index.js"',children:"(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object')\n    factory(exports);\n  else if (typeof define === 'function' && define.amd)\n    define(['exports'], factory);\n  else if (\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\n  )\n    factory((global.index = {}));\n})(this, function (exports) {\n  //...\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679C\u9700\u8981\u4FEE\u6539\u5B83\uFF0C\u5219\u9700\u8981\u4F7F\u7528 ",(0,i.jsx)(n.a,{href:"/api/config/build-config#umdmodulename",children:(0,i.jsx)(n.code,{children:"buildConfig.umdModuleName"})})," API\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u5F53\u4F7F\u7528\u8BE5 API \u540E\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: {\n    format: 'umd',\n    umdModuleName: 'myLib',\n  },\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6B64\u65F6\u6784\u5EFA\u4EA7\u7269\u7684\u5185\u5BB9\u4E3A\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",meta:'title="./dist/index.js"',children:"(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object')\n    factory(exports);\n  else if (typeof define === 'function' && define.amd)\n    define(['exports'], factory);\n  else if (\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\n  )\n    factory((global.myLib = {}));\n})(this, function (exports) {\n  //...\n});\n"})})]})}function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,d.useMDXComponents)(),e.components);return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}var c=r;r.__RSPRESS_PAGE_META={},r.__RSPRESS_PAGE_META["zh%2Fguide%2Fadvance%2Fbuild-umd.mdx"]={toc:[{text:"umd \u4EA7\u7269\u7684\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5904\u7406",id:"umd-\u4EA7\u7269\u7684\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5904\u7406",depth:2},{text:"\u793A\u4F8B",id:"\u793A\u4F8B",depth:3},{text:"\u4E09\u65B9\u4F9D\u8D56\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",id:"\u4E09\u65B9\u4F9D\u8D56\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",depth:3},{text:"\u66F4\u6539\u9879\u76EE\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",id:"\u66F4\u6539\u9879\u76EE\u7684\u5168\u5C40\u53D8\u91CF\u540D\u79F0",depth:2}],title:"\u6784\u5EFA umd \u4EA7\u7269",frontmatter:{sidebar_position:5}}}}]);