{"version":3,"file":"static/js/async/docs_zh_guide_advance_build-umd_mdx.abec2dcf.js","sources":["./docs/zh/guide/advance/build-umd.mdx"],"sourcesContent":["globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"zh%2Fguide%2Fadvance%2Fbuild-umd.mdx\"] = {\"toc\":[{\"text\":\"umd 产物的第三方依赖处理\",\"id\":\"umd-产物的第三方依赖处理\",\"depth\":2},{\"text\":\"示例\",\"id\":\"示例\",\"depth\":3},{\"text\":\"三方依赖的全局变量名称\",\"id\":\"三方依赖的全局变量名称\",\"depth\":3},{\"text\":\"更改项目的全局变量名称\",\"id\":\"更改项目的全局变量名称\",\"depth\":2}],\"title\":\"构建 umd 产物\",\"frontmatter\":{\"sidebar_position\":5}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        h1: \"h1\",\n        a: \"a\",\n        p: \"p\",\n        strong: \"strong\",\n        ul: \"ul\",\n        li: \"li\",\n        pre: \"pre\",\n        code: \"code\",\n        h2: \"h2\",\n        h3: \"h3\"\n    }, _provideComponents(), props.components);\n    return <><_components.h1 id=\"构建-umd-产物\">{\"构建 umd 产物\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#构建-umd-产物\">{\"#\"}</_components.a></_components.h1>{\"\\n\"}<_components.p>{\"umd 全称为 \"}<_components.strong>{\"Universal Module Definition\"}</_components.strong>{\"，这种格式的 JS 文件可以运行在多个运行环境：\"}</_components.p>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"浏览器环境：基于 AMD 规范进行模块加载\"}</_components.li>{\"\\n\"}<_components.li>{\"Node.js 环境：基于 CommonJS 进行模块加载\"}</_components.li>{\"\\n\"}<_components.li>{\"其他情况：将模块挂载在全局对象上。\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.p>{\"因此我们可以通过下面的方式，将项目的构建产物指定为 umd 产物：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"export default defineConfig({\\n  buildConfig: {\\n    format: 'umd',\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.h2 id=\"umd-产物的第三方依赖处理\">{\"umd 产物的第三方依赖处理\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#umd-产物的第三方依赖处理\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"在 \"}<_components.a href=\"/guide/advance/external-dependency\">{\"「如何处理第三方依赖」\"}</_components.a>{\" 章节中，我们知道可以通过 \"}<_components.a href=\"/api/config/build-config#autoexternal\"><_components.code>{\"autoExternals\"}</_components.code></_components.a>{\" 和 \"}<_components.a href=\"/api/config/build-config#externals\"><_components.code>{\"externals\"}</_components.code></_components.a>{\" API 来控制项目是否对第三方依赖打包。\\n因此在构建 umd 产物的过程中，我们也可以这样使用：\"}</_components.p>{\"\\n\"}<_components.h3 id=\"示例\">{\"示例\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#示例\">{\"#\"}</_components.a></_components.h3>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"如果项目依赖了 \"}<_components.code>{\"react\"}</_components.code>{\"：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-json\" meta='title=\"package.json\"'>{'{\\n  \"dependencies\": {\\n    \"react\": \"^17\"\\n  }\\n}\\n'}</_components.code></_components.pre>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li><_components.code>{\"modern.config.ts\"}</_components.code>{\" 配置：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\" meta='title=\"modern.config.ts\"'>{\"export default defineConfig({\\n  buildConfig: {\\n    format: 'umd',\\n    autoExternal: false,\\n    externals: ['react'],\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"当源码中使用了 \"}<_components.code>{\"react\"}</_components.code>{\" 依赖：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-tsx\" meta='title=\"src/index.ts\"'>{\"import React from 'react';\\nconsole.info(React);\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"此时产物中不会将 \"}<_components.code>{\"react\"}</_components.code>{\" 代码打包到产物中：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-js\" meta='title=\"dist/index.js\"'>{\"(function (global, factory) {\\n  if (typeof module === 'object' && typeof module.exports === 'object')\\n    factory(exports, require('react'));\\n  else if (typeof define === 'function' && define.amd)\\n    define(['exports', 'react'], factory);\\n  else if (\\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\\n  )\\n    factory((global.index = {}), global.react);\\n})(this, function (exports, _react) {\\n  'use strict';\\n  Object.defineProperty(exports, '__esModule', {\\n    value: true,\\n  });\\n  _react = /*#__PURE__*/ _interopRequireDefault(_react);\\n  function _interopRequireDefault(obj) {\\n    return obj && obj.__esModule\\n      ? obj\\n      : {\\n          default: obj,\\n        };\\n  }\\n  console.info(_react.default);\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"通过上面的例子我们知道，当使用 \"}<_components.code>{\"autoExternal\"}</_components.code>{\" 和 \"}<_components.code>{\"externals\"}</_components.code>{\" API 后：\"}</_components.p>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"在 Node.js 环境下，可以通过 \"}<_components.code>{\"require('react')\"}</_components.code>{\" 获取 react 依赖。\"}</_components.li>{\"\\n\"}<_components.li>{\"在 浏览器环境下，可以通过 \"}<_components.code>{\"global.react\"}</_components.code>{\" 获取 react 依赖。\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.h3 id=\"三方依赖的全局变量名称\">{\"三方依赖的全局变量名称\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#三方依赖的全局变量名称\">{\"#\"}</_components.a></_components.h3>{\"\\n\"}<_components.p>{\"然而在浏览器环境下，获取第三方依赖的时候，\"}<_components.strong>{\"全局变量名称不一定与依赖名称完全相同\"}</_components.strong>{\"，此时就要使用 \"}<_components.a href=\"/api/config/build-config#umdglobals\"><_components.code>{\"buildConfig.umdGlobals\"}</_components.code></_components.a>{\" API。\"}</_components.p>{\"\\n\"}<_components.p>{\"还是使用之前的例子，当 \"}<_components.code>{\"react\"}</_components.code>{\" 依赖以 \"}<_components.code>{\"windows.React\"}</_components.code>{\" 或者 \"}<_components.code>{\"global.React\"}</_components.code>{\" 全局变量的形式存在于浏览器环境下，那么此时：\"}</_components.p>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li><_components.code>{\"modern.config.ts\"}</_components.code>{\" 配置：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"export default defineConfig({\\n  buildConfig: {\\n    format: 'umd',\\n    umdGlobals: {\\n      react: 'React',\\n    },\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"当源码中使用了 \"}<_components.code>{\"react\"}</_components.code>{\" 依赖：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-tsx\" meta='title=\"src/index.ts\"'>{\"import React from 'react';\\nconsole.info(React);\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"此时我们会看到这样的产物代码：\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-js\" meta='title=\"dist/index.js\"'>{\"(function (global, factory) {\\n  if (typeof module === 'object' && typeof module.exports === 'object')\\n    factory();\\n  else if (typeof define === 'function' && define.amd) define([], factory);\\n  else if (\\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\\n  )\\n    factory();\\n})(this, function () {\\n  // ...\\n  // libuild:globals:react\\n  var require_react = __commonJS({\\n    'libuild:globals:react'(exports, module1) {\\n      module1.exports = Function('return this')()['React'];\\n    },\\n  });\\n  // src/index.ts\\n  var import_react = __toESM(require_react());\\n  console.info(import_react.default);\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"此时项目就可以运行在浏览器中，并使用存在于全局对象上的 \"}<_components.code>{\"React\"}</_components.code>{\" 变量了。\"}</_components.p>{\"\\n\"}<_components.h2 id=\"更改项目的全局变量名称\">{\"更改项目的全局变量名称\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#更改项目的全局变量名称\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"当我们将下面的代码打包成 umd 产物并运行在浏览器的时候，我们可以通过 \"}<_components.code>{\"window.index\"}</_components.code>{\" 来使用该模块。\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\" meta='title=\"./src/index.ts\"'>{\"export default () => {\\n  console.info('hello world');\\n};\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p><_components.strong>{\"默认情况下，以源码文件名称作为该模块在浏览器里全局变量的名称\"}</_components.strong>{\"。对于上面的例子，其产物内容如下：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-js\" meta='title=\"./dist/index.js\"'>{\"(function (global, factory) {\\n  if (typeof module === 'object' && typeof module.exports === 'object')\\n    factory(exports);\\n  else if (typeof define === 'function' && define.amd)\\n    define(['exports'], factory);\\n  else if (\\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\\n  )\\n    factory((global.index = {}));\\n})(this, function (exports) {\\n  //...\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"如果需要修改它，则需要使用 \"}<_components.a href=\"/api/config/build-config#umdmodulename\"><_components.code>{\"buildConfig.umdModuleName\"}</_components.code></_components.a>{\" API。\"}</_components.p>{\"\\n\"}<_components.p>{\"当使用该 API 后：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"export default defineConfig({\\n  buildConfig: {\\n    format: 'umd',\\n    umdModuleName: 'myLib',\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"此时构建产物的内容为：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-js\" meta='title=\"./dist/index.js\"'>{\"(function (global, factory) {\\n  if (typeof module === 'object' && typeof module.exports === 'object')\\n    factory(exports);\\n  else if (typeof define === 'function' && define.amd)\\n    define(['exports'], factory);\\n  else if (\\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self)\\n  )\\n    factory((global.myLib = {}));\\n})(this, function (exports) {\\n  //...\\n});\\n\"}</_components.code></_components.pre></>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","a","p","strong","ul","li","pre","code","h2","h3","components","id","className","href","meta","globalThis","__RSPRESS_PAGE_META","MDXLayout","wrapper","_"],"mappings":"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"}