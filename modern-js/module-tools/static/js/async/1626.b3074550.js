/*! For license information please see 1626.b3074550.js.LICENSE.txt */
(self.webpackChunk_modern_js_module_tools_docs=self.webpackChunk_modern_js_module_tools_docs||[]).push([["1626"],{15101:function(e,o,n){"use strict";n.r(o);var r=n("39980"),s=n("96954");function i(e){let o=Object.assign({h1:"h1",a:"a",p:"p",ul:"ul",li:"li",h2:"h2",h3:"h3",pre:"pre",code:"code",div:"div",blockquote:"blockquote",strong:"strong",h4:"h4"},(0,s.useMDXComponents)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.h1,{id:"using-storybook",children:["Using Storybook",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#using-storybook",children:"#"})]}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.a,{href:"https://storybook.js.org/",target:"_blank",rel:"noopener noreferrer",children:"Storybook"})," is a tool dedicated to component debugging, providing around component development."]}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"Develop UIs that are more durable"}),"\n",(0,r.jsx)(o.li,{children:"Test UIs with less effort and no flakes"}),"\n",(0,r.jsx)(o.li,{children:"Document UI for your team to reuse"}),"\n",(0,r.jsx)(o.li,{children:"Share how the UI actually works"}),"\n",(0,r.jsx)(o.li,{children:"Automate UI workflows"}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:"Before when using Storybook, there are various problems related to configurations, Babel, Webpack, less or sass.\nModern.js integrates with Storybook, which greatly simplifies configuration for us as we develop our Storybook project."}),"\n",(0,r.jsxs)(o.h2,{id:"v7-recommended",children:["V7 (Recommended)",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#v7-recommended",children:"#"})]}),"\n",(0,r.jsxs)(o.h3,{id:"enable-storybook",children:["Enable Storybook",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#enable-storybook",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"You can directly enable the Storybook feature by using the following command:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-bash",children:"$ npx modern new\n? Please select the operation you want: Enable features\n? Please select the feature name: Enable\u300CStorybook\u300DV7\n"})}),"\n",(0,r.jsx)(o.p,{children:"This command will create a template for Storybook, including:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"Creating a configuration folder .storybook and a default configuration file .storybook/main.ts."}),"\n",(0,r.jsx)(o.li,{children:"Creating example story components."}),"\n",(0,r.jsx)(o.li,{children:"Updating package.json to add dependencies @storybook/addon-essentials and @modern-js/storybook, as well as creating Storybook-related scripts."}),"\n"]}),"\n",(0,r.jsxs)(o.h3,{id:"enable-debug-output",children:["Enable Debug output",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#enable-debug-output",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"In fact, Modern.js Module is implemented based on esbuild, while Storybook uses Webpack as the default build tool, and their configurations are not fully compatible. Therefore, we recommend building the components first, and then importing the component output in stories."}),"\n",(0,r.jsx)(o.p,{children:"The way to import component outputs is very simple. Suppose your module exports a Button component, then you can use it in stories like this:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-ts",meta:'filename="stories/index.stories.tsx"',children:"import { Button } from '.';\n\nexport const YourStory = () => <Button />;\n\nexport default {\n  title: 'Your Stories',\n};\n"})}),"\n",(0,r.jsx)(o.p,{children:"If you want to update the components, you can start the build in watch mode before starting Storybook:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-bash",children:"modern build --watch\n"})}),"\n",(0,r.jsxs)(o.div,{className:"rspress-directive info",children:[(0,r.jsx)(o.div,{className:"rspress-directive-title",children:"INFO"}),(0,r.jsxs)(o.div,{className:"rspress-directive-content",children:[(0,r.jsx)(o.p,{children:"In the development process, you may encounter situations where you cannot get type definitions in real time. Because only when the code is saved, the type file under the output directory will be updated. At this time:"}),"\n",(0,r.jsxs)(o.p,{children:["For ",(0,r.jsx)(o.code,{children:"pnpm"})," projects, you can modify the ",(0,r.jsx)(o.code,{children:"package.json"})," as follows:"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-ts",children:'{\n    "name": "foo",\n    "main": "./dist/index.js",\n    "types": "./src/index.ts",\n    "publishConfig": {\n      "types": "./dist/index.d.ts",\n    }\n}\n'})}),"\n",(0,r.jsxs)(o.blockquote,{children:["\n",(0,r.jsxs)(o.p,{children:["For the use of ",(0,r.jsx)(o.code,{children:"publishConfig"})," in pnpm, you can read the following ",(0,r.jsx)(o.a,{href:"https://pnpm.io/package_json#publishconfig",target:"_blank",rel:"noopener noreferrer",children:"link"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["For npm and Yarn projects, the ",(0,r.jsx)(o.code,{children:"types"})," value of ",(0,r.jsx)(o.code,{children:"package.json"})," can only be modified manually during the ",(0,r.jsx)(o.strong,{children:"development stage"})," and ",(0,r.jsx)(o.strong,{children:"release stage"}),".\n"]})]})]}),"\n",(0,r.jsxs)(o.h3,{id:"enable-rspack-build",children:["Enable Rspack build",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#enable-rspack-build",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"Rspack is known for its fast build speed. To use Rspack as a build tool in Modern.js, you only need to configure it as follows:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-diff",meta:"filename='.storybook/main.js'",children:"const config = {\n  framework: {\n    name: '@modern-js/storybook',\n    options: {\n-      bundler: 'webpack'\n+      bundler: 'rspack'\n    },\n  },\n  typescript: {\n-    reactDocgen: 'react-docgen-typescript'\n+    reactDocgen: 'react-docgen'\n  }\n};\n\nexport default config;\n"})}),"\n",(0,r.jsx)(o.p,{children:"Note that in the above configuration, the reactDocgen configuration has been changed because Rspack currently does not support @storybook/react-docgen-typescript-plugin."}),"\n",(0,r.jsxs)(o.h3,{id:"configurations",children:["Configurations",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#configurations",children:"#"})]}),"\n",(0,r.jsxs)(o.p,{children:["There are some separate configurations in ",(0,r.jsx)(o.code,{children:".storybook/main.js"}),"."]}),"\n",(0,r.jsxs)(o.h4,{id:"bundler",children:["bundler",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#bundler",children:"#"})]}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Type"}),": ",(0,r.jsx)(o.code,{children:"'webpack' | 'rspack'"})]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Default"}),": ",(0,r.jsx)(o.code,{children:"webpack"})]}),"\n"]}),"\n",(0,r.jsx)(o.p,{children:"Specify the underlying bundler to use either Webpack or Rspack."}),"\n",(0,r.jsx)(o.p,{children:"Example:"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",meta:"filename='.storybook/main.js'",children:"const config = {\n  framework: {\n    name: '@modern-js/storybook',\n    options: {\n      bundler: 'rspack',\n    },\n  },\n};\n\nexport default config;\n"})}),"\n",(0,r.jsxs)(o.h4,{id:"builderconfig",children:["builderConfig",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#builderconfig",children:"#"})]}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Type"}),": ",(0,r.jsx)(o.code,{children:"BuilderConfig"})]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.strong,{children:"Default"}),": ",(0,r.jsx)(o.code,{children:"undefined"})]}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["The Storybook build capability of Modern.js is provided by ",(0,r.jsx)(o.a,{href:"https://rsbuild.dev/",target:"_blank",rel:"noopener noreferrer",children:"Rsbuild"}),", and the Rsbuild configuration can be modified through builderConfig."]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-javascript",meta:"filename='.storybook/main.js'",children:"const config = {\n  framework: {\n    name: '@modern-js/storybook',\n    options: {\n      builderConfig: {\n        alias: {\n          react: require.resolve('react'),\n          'react-dom': require.resolve('react-dom'),\n        },\n      },\n    },\n  },\n};\n\nexport default config;\n"})}),"\n",(0,r.jsxs)(o.h3,{id:"command",children:["Command",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#command",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"@modern-js/storybook proxies some storybook cli commands"}),"\n",(0,r.jsxs)(o.h4,{id:"storybook-dev",children:["storybook dev",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#storybook-dev",children:"#"})]}),"\n",(0,r.jsxs)(o.p,{children:["Start Storybook,",(0,r.jsx)(o.a,{href:"https://storybook.js.org/docs/react/api/cli-options#dev",target:"_blank",rel:"noopener noreferrer",children:"detail"})]}),"\n",(0,r.jsxs)(o.h4,{id:"storybook-build",children:["storybook build",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#storybook-build",children:"#"})]}),"\n",(0,r.jsxs)(o.p,{children:["Build Storybook for production,",(0,r.jsx)(o.a,{href:"https://storybook.js.org/docs/react/api/cli-options#build",target:"_blank",rel:"noopener noreferrer",children:"detail"})]}),"\n",(0,r.jsxs)(o.h2,{id:"migrate-from-v6-to-v7",children:["Migrate from V6 to V7",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#migrate-from-v6-to-v7",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"Our support methods for the two versions are different, so if you are migrating from V6 to V7,\nwe hope you will also use V7 in the same way, while making the following adjustments:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["Configuration file: Migrate any custom configurations (if any) in the original ",(0,r.jsx)(o.code,{children:"root/config/storybook/main.(j|t)s"})," to the new ",(0,r.jsx)(o.code,{children:"root/.storybook/main.(j|t)s"}),"."]}),"\n",(0,r.jsxs)(o.li,{children:["Dependencies: Upgrade ",(0,r.jsx)(o.code,{children:"@storybook/addon-*"})," series dependencies (if any) to version 7 and delete ",(0,r.jsx)(o.code,{children:"@modern-js/plugin-storybook"})," dependencies."]}),"\n",(0,r.jsxs)(o.li,{children:["Commands: Delete the original ",(0,r.jsx)(o.code,{children:"edenx dev storybook"})," and ",(0,r.jsx)(o.code,{children:"edenx build --platform"})," commands.\nIf you are used to the original ",(0,r.jsx)(o.code,{children:"pnpm run dev"})," usage, you can replace it with ",(0,r.jsx)(o.code,{children:"storybook dev -p 6006"})," and ",(0,r.jsx)(o.code,{children:"storybook build"}),"."]}),"\n",(0,r.jsxs)(o.li,{children:["modern.config.(j|t)s : Remove the registration of ",(0,r.jsx)(o.code,{children:"@modern-js/plugin-storybook"})," plugin."]}),"\n"]}),"\n",(0,r.jsxs)(o.h2,{id:"v6-legacy",children:["V6 (legacy)",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#v6-legacy",children:"#"})]}),"\n",(0,r.jsxs)(o.p,{children:["Starting from ",(0,r.jsx)(o.code,{children:"2.40.0"})," version, ",(0,r.jsx)(o.code,{children:"@modern-js/plugin-storybook"})," will stop iterating. It is recommended to use the V7 version.\nIf your ",(0,r.jsx)(o.code,{children:"@modern-js/module-tools"})," version is lower than ",(0,r.jsx)(o.code,{children:"2.40.0"}),", you can use Storybook V6 in the following ways:"]}),"\n",(0,r.jsxs)(o.h3,{id:"start-storybook",children:["Start Storybook",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#start-storybook",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"You can directly use the following command to enable the Storybook feature."}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-bash",children:'$ npx modern new\n? Please select the operation you want Enable optional features\n? Please select the function name Enable "Storybook"\n'})}),"\n",(0,r.jsx)(o.p,{children:"This command will create commonly used templates for Storybook, including"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"Create stories component examples"}),"\n",(0,r.jsxs)(o.li,{children:["Update package.json, add a dependency on @modern-js/plugin-storybook, and add related scripts such as ",(0,r.jsx)(o.code,{children:"pnpm dev storybook"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(o.h3,{id:"configure-storybook",children:["Configure Storybook",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-storybook",children:"#"})]}),"\n",(0,r.jsxs)(o.p,{children:["The Storybook official configures the project through a folder named ",(0,r.jsx)(o.code,{children:".storybook"}),", which contains various configuration files. ",(0,r.jsxs)(o.strong,{children:["In Modern.js Module, you can add Storybook configuration files in the project's ",(0,r.jsx)(o.code,{children:"config/storybook"})," directory."]})]}),"\n",(0,r.jsx)(o.p,{children:"For how to use various Storybook configuration files, you can check the following link:"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:(0,r.jsx)(o.a,{href:"https://storybook.js.org/docs/react/configure/overview",target:"_blank",rel:"noopener noreferrer",children:"Configure Storybook"})}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.strong,{children:"However, there are some restrictions when using it in module projects"}),":"]}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:["Cannot change the location where Story files are stored, that is, the ",(0,r.jsx)(o.code,{children:"stories"})," configuration cannot be modified in the ",(0,r.jsx)(o.code,{children:"main.js"})," file."]}),"\n",(0,r.jsxs)(o.li,{children:["Cannot modify the configuration related to Webpack and Babel, that is, the ",(0,r.jsx)(o.code,{children:"webpackFinal"})," and ",(0,r.jsx)(o.code,{children:"babel"})," configurations cannot be modified in the ",(0,r.jsx)(o.code,{children:"main.js"})," file."]}),"\n"]}),"\n",(0,r.jsxs)(o.h3,{id:"build-storybook-output",children:["Build Storybook Output",(0,r.jsx)(o.a,{className:"header-anchor","aria-hidden":"true",href:"#build-storybook-output",children:"#"})]}),"\n",(0,r.jsx)(o.p,{children:"In addition to debugging the component or ordinary modules with Storybook, you can also use the following command to execute the Storybook build task."}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-bash",children:"modern build --platform storybook\n"})}),"\n",(0,r.jsxs)(o.p,{children:["After the build is complete, you can see the build output files in the ",(0,r.jsx)(o.code,{children:"dist/storybook-static"})," directory."]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:o}=Object.assign({},(0,s.useMDXComponents)(),e.components);return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}o.default=t,t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["en%2Fguide%2Fbasic%2Fusing-storybook.mdx"]={toc:[{text:"V7 (Recommended)",id:"v7-recommended",depth:2},{text:"Enable Storybook",id:"enable-storybook",depth:3},{text:"Enable Debug output",id:"enable-debug-output",depth:3},{text:"Enable Rspack build",id:"enable-rspack-build",depth:3},{text:"Configurations",id:"configurations",depth:3},{text:"bundler",id:"bundler",depth:4},{text:"builderConfig",id:"builderconfig",depth:4},{text:"Command",id:"command",depth:3},{text:"storybook dev",id:"storybook-dev",depth:4},{text:"storybook build",id:"storybook-build",depth:4},{text:"Migrate from V6 to V7",id:"migrate-from-v6-to-v7",depth:2},{text:"V6 (legacy)",id:"v6-legacy",depth:2},{text:"Start Storybook",id:"start-storybook",depth:3},{text:"Configure Storybook",id:"configure-storybook",depth:3},{text:"Build Storybook Output",id:"build-storybook-output",depth:3}],title:"Using Storybook",frontmatter:{sidebar_position:5}}}}]);