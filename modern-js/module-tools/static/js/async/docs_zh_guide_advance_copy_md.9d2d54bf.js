(self.webpackChunk_modern_js_module_tools_docs=self.webpackChunk_modern_js_module_tools_docs||[]).push([["docs_zh_guide_advance_copy_md"],{91618:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return l}});var i,o=r("15169"),d=r("43932"),t=r("9880"),s=r("23169");function c(n){var e=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",code:"code",ul:"ul",li:"li",pre:"pre",blockquote:"blockquote",h3:"h3"},(0,s.useMDXComponents)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.h1,{id:"使用-copy-工具",children:["使用 Copy 工具",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#使用-copy-工具",children:"#"})]}),"\n",(0,t.jsx)(e.p,{children:"模块工程提供了 Copy 工具用于将已经存在的单个文件或整个目录复制到产物目录中。接下来我们学习如何使用它。"}),"\n",(0,t.jsxs)(e.h2,{id:"了解-copy-api",children:["了解 Copy API",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#了解-copy-api",children:"#"})]}),"\n",(0,t.jsxs)(e.p,{children:["我们可以通过 ",(0,t.jsx)(e.a,{href:"/api/config/build-config#copy",children:(0,t.jsx)(e.code,{children:"buildConfig.copy"})})," API 来使用 Copy 工具，它包含以下两个主要配置："]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/api/config/build-config#copypatterns",children:(0,t.jsx)(e.code,{children:"patterns"})})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"/api/config/build-config#copyoptions",children:(0,t.jsx)(e.code,{children:"options"})})}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"api-详解",children:["API 详解",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#api-详解",children:"#"})]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"copy.patterns"})," 用于寻找复制的文件以及配置输出的路径。"]}),"\n",(0,t.jsxs)(e.p,{children:["其中 ",(0,t.jsx)(e.code,{children:"patterns.from"})," 用于指定要复制的文件或者目录。它接收 Glob 形式字符串或具体路径。Glob 形式字符串是指 ",(0,t.jsx)(e.a,{href:"https://github.com/mrmlnc/fast-glob#pattern-syntax",target:"_blank",rel:"noopener noreferrer",children:"fast-glob pattern-syntax"}),"。因此我们可以按照如下两种方式使用它："]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: {\n    copy: {\n      patterns: [\n        { from: './index.html', to: '' },\n        { from: './*.html', to: '' },\n      ],\n    },\n  },\n});\n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"patterns.context"})," 一般和 ",(0,t.jsx)(e.code,{children:"patterns.from"})," 配合使用，默认情况下它的值与 ",(0,t.jsx)(e.a,{href:"/api/config/build-config#sourcedir",children:(0,t.jsx)(e.code,{children:"buildConfig.sourceDir"})})," 相同，因此我们可以按照如下方式指定 ",(0,t.jsx)(e.code,{children:"src/data.json"})," 文件为要复制的文件："]}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.p,{children:["默认情况下，",(0,t.jsx)(e.code,{children:"buildConfig.sourceDir"})," 为 ",(0,t.jsx)(e.code,{children:"src"})]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: {\n    copy: {\n      patterns: [\n        { from: './data.json' to: ''},\n      ],\n    },\n  },\n});\n"})}),"\n",(0,t.jsxs)(e.p,{children:["当指定的文件不在源码目录的时候，可以修改 ",(0,t.jsx)(e.code,{children:"context"})," 配置。例如指定项目目录下的 ",(0,t.jsx)(e.code,{children:"temp/index.html"})," 为要复制的文件："]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"import path from 'path';\n\nexport default defineConfig({\n  buildConfig: {\n    copy: {\n      patterns: [\n        {\n          from: './index.html',\n          context: path.join(__dirname, './temp')\n          to: '',\n        }\n      ],\n    },\n  },\n});\n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"patterns.to"})," 用于指定复制文件的输出路径，默认情况下它的值为 ",(0,t.jsx)(e.a,{href:"/api/config/build-config#outDir",children:(0,t.jsx)(e.code,{children:"buildConfig.outDir"})}),"对应的值。因此我们按照如下方式将 ",(0,t.jsx)(e.code,{children:"src/index.html"})," 复制到 ",(0,t.jsx)(e.code,{children:"dist"})," 目录下："]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: {\n    copy: {\n      patterns: [{ from: './index.html' }],\n    },\n  },\n});\n"})}),"\n",(0,t.jsxs)(e.p,{children:["当我们配置了 ",(0,t.jsx)(e.code,{children:"patterns.to"})," 的时候："]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["如果是相对路径，则该路径会相对于 ",(0,t.jsx)(e.code,{children:"buildConfig.outDir"})," 计算出复制文件输出的绝对路径。"]}),"\n",(0,t.jsx)(e.li,{children:"如果是绝对路径，则会直接使用该值。"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["最后 ",(0,t.jsx)(e.code,{children:"patterns.globOptions"})," 用于配置寻找复制文件 ",(0,t.jsx)(e.a,{href:"https://github.com/sindresorhus/globby",target:"_blank",rel:"noopener noreferrer",children:"globby"})," 对象，其配置可参考："]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://github.com/sindresorhus/globby#options",target:"_blank",rel:"noopener noreferrer",children:"globby.options"})}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"不同场景使用示例",children:["不同场景使用示例",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#不同场景使用示例",children:"#"})]}),"\n",(0,t.jsxs)(e.h3,{id:"将文件复制文件",children:["将文件复制文件",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#将文件复制文件",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: [\n    {\n      outDir: 'dist',\n      copy: {\n        patterns: [\n          /**\n           * copy file to file\n           */\n          {\n            from: './temp-1/a.png',\n            context: __dirname,\n            to: './temp-1/b.png',\n          },\n        ],\n      },\n    },\n  ],\n});\n"})}),"\n",(0,t.jsxs)(e.h3,{id:"将文件复制到目录",children:["将文件复制到目录",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#将文件复制到目录",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: [\n    {\n      outDir: 'dist',\n      copy: {\n        patterns: [\n          /**\n           * copy file to dir\n           */\n          {\n            from: './temp-2/a.png',\n            context: __dirname,\n            to: './temp-2',\n          },\n        ],\n      },\n    },\n  ],\n});\n"})}),"\n",(0,t.jsxs)(e.h3,{id:"从目录复制到目录",children:["从目录复制到目录",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#从目录复制到目录",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: [\n    {\n      outDir: 'dist',\n      copy: {\n        patterns: [\n          /**\n           * copy dir to dir\n           */\n          {\n            from: './temp-3/',\n            to: './temp-3',\n            context: __dirname,\n          },\n        ],\n        options: {\n          enableCopySync: true,\n        },\n      },\n    },\n  ],\n});\n"})}),"\n",(0,t.jsxs)(e.h3,{id:"从目录到文件",children:["从目录到文件",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#从目录到文件",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: [\n    {\n      outDir: 'dist',\n      copy: {\n        patterns: [\n          /**\n           * copy dir to file\n           */\n          {\n            from: './temp-4/',\n            context: __dirname,\n            to: './temp-4/_index.html',\n          },\n        ],\n        options: {\n          enableCopySync: true,\n        },\n      },\n    },\n  ],\n});\n"})}),"\n",(0,t.jsxs)(e.h3,{id:"使用-glob",children:["使用 Glob",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#使用-glob",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export default defineConfig({\n  buildConfig: [\n    {\n      outDir: 'dist',\n      copy: {\n        patterns: [\n          /**\n           * copy glob to dir\n           */\n          {\n            from: './*.html',\n            to: './temp-5',\n          },\n        ],\n        options: {\n          enableCopySync: true,\n        },\n      },\n    },\n    {\n      copy: {\n        patterns: [\n          /**\n           * copy glob to file\n           */\n          {\n            from: './*.html',\n            to: './temp-6/index.html',\n          },\n        ],\n        options: {\n          enableCopySync: true,\n        },\n      },\n    },\n  ],\n});\n"})})]})}(i=globalThis).__RSPRESS_PAGE_META||(i.__RSPRESS_PAGE_META={}),globalThis.__RSPRESS_PAGE_META["zh%2Fguide%2Fadvance%2Fcopy.md"]={toc:[{text:"了解 Copy API",id:"了解-copy-api",depth:2},{text:"API 详解",id:"api-详解",depth:2},{text:"不同场景使用示例",id:"不同场景使用示例",depth:2},{text:"将文件复制文件",id:"将文件复制文件",depth:3},{text:"将文件复制到目录",id:"将文件复制到目录",depth:3},{text:"从目录复制到目录",id:"从目录复制到目录",depth:3},{text:"从目录到文件",id:"从目录到文件",depth:3},{text:"使用 Glob",id:"使用-glob",depth:3}],title:"使用 Copy 工具",frontmatter:{sidebar_position:3}};var l=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},(0,s.useMDXComponents)(),n.components).wrapper;return e?(0,t.jsx)(e,(0,d._)((0,o._)({},n),{children:(0,t.jsx)(c,(0,o._)({},n))})):c(n)}}}]);