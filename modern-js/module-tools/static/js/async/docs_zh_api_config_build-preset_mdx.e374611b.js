(self.webpackChunk_modern_js_module_tools_docs=self.webpackChunk_modern_js_module_tools_docs||[]).push([["docs_zh_api_config_build-preset_mdx"],{10218:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return c}});var s,d=r("15169"),i=r("43932"),t=r("9880"),l=r("23169");function o(e){var n=Object.assign({h1:"h1",a:"a",p:"p",ul:"ul",li:"li",code:"code",h2:"h2",div:"div",pre:"pre",em:"em"},(0,l.useMDXComponents)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{id:"buildpreset",children:["buildPreset",(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#buildpreset",children:"#"})]}),"\n",(0,t.jsx)(n.p,{children:"构建的预设字符串或者预设函数。提供开箱即用的构建配置。"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["类型：",(0,t.jsx)(n.code,{children:"string | Function"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["默认值: ",(0,t.jsx)(n.code,{children:"undefined"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"npm-library",children:[(0,t.jsx)(n.code,{children:"npm-library"}),(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#npm-library",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:["在类 ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer",children:"NPM"})," 包管理器下使用的 Library 通用模式，包含 ",(0,t.jsx)(n.code,{children:"esm"})," 和 ",(0,t.jsx)(n.code,{children:"cjs"})," 两种 Bundle 产物，并且包含一份类型文件。"]}),"\n",(0,t.jsxs)(n.div,{className:"modern-directive info",children:[(0,t.jsx)(n.div,{className:"modern-directive-title",children:"INFO"}),(0,t.jsxs)(n.div,{className:"modern-directive-content",children:[(0,t.jsxs)(n.p,{children:["关于类 ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer",children:"NPM"})," 包管理器"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.npmjs.com",target:"_blank",rel:"noopener noreferrer",children:"npm"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://yarnpkg.com/",target:"_blank",rel:"noopener noreferrer",children:"yarn"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://pnpm.io/",target:"_blank",rel:"noopener noreferrer",children:"pnpm"})}),"\n"]}),"\n"]})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",meta:'title="package.json"',children:'{\n  "main": "./dist/lib/index.js",\n  "module": "./dist/es/index.js",\n  "types": "./dist/types/index.d.ts"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"预设字符串对应的构建配置："}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"export const buildConfig = [\n  {\n    format: 'cjs',\n    target: 'es6',\n    buildType: 'bundle',\n    outDir: './dist/lib',\n  },\n  {\n    format: 'esm',\n    target: 'es6',\n    buildType: 'bundle',\n    outDir: './dist/es',\n  },\n  {\n    buildType: 'bundle',\n    outDir: './dist/types',\n    dts: {\n      only: true,\n    },\n  },\n];\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"npm-library-with-umd",children:[(0,t.jsx)(n.code,{children:"npm-library-with-umd"}),(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#npm-library-with-umd",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:["在类 ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer",children:"NPM"})," 包管理器下使用，并且 Library 支持类似 ",(0,t.jsx)(n.a,{href:"https://unpkg.com/",target:"_blank",rel:"noopener noreferrer",children:"unpkg"})," 的模式。在预设 ",(0,t.jsx)(n.code,{children:"'npm-library'"})," 的基础上，额外提供 ",(0,t.jsx)(n.code,{children:"umd"})," 产物。"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",meta:'title="package.json"',children:'{\n    "main": "./dist/lib/index.js",\n    "module": "./dist/es/index.js",\n    "types": "./dist/types/index.d.ts",\n    "unpkg": "./dist/umd/index.js",\n};\n'})}),"\n",(0,t.jsx)(n.p,{children:"预设字符串对应的构建配置："}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"export const buildConfig = [\n  {\n    format: 'cjs',\n    target: 'es6',\n    buildType: 'bundle',\n    outDir: './dist/lib',\n  },\n  {\n    format: 'esm',\n    target: 'es6',\n    buildType: 'bundle',\n    outDir: './dist/es',\n  },\n  {\n    format: 'umd',\n    target: 'es6',\n    platform: 'browser',\n    buildType: 'bundle',\n    outDir: './dist/umd',\n  },\n  {\n    buildType: 'bundle',\n    outDir: './dist/types',\n    dts: {\n      only: true,\n    },\n  },\n];\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"npm-component",children:[(0,t.jsx)(n.code,{children:"npm-component"}),(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#npm-component",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:["在类 ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer",children:"NPM"})," 包管理器下使用的 组件（库）通用模式。包含 ",(0,t.jsx)(n.code,{children:"esm"})," 和 ",(0,t.jsx)(n.code,{children:"cjs"})," 两种 Bundleless 产物（便于 ",(0,t.jsx)(n.em,{children:(0,t.jsx)(n.a,{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Tree_shaking",target:"_blank",rel:"noopener noreferrer",children:"Tree shaking"})})," 优化），以及包含一份类型文件。"]}),"\n",(0,t.jsx)(n.p,{children:"对于源码中包含的样式文件，产物中提供样式的编译产物和样式的源文件。"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",meta:'title="package.json"',children:'{\n    "main": "./dist/lib/index.js", // bundleless type\n    "module": "./dist/es/index.js", // bundleless type\n    "types": "./dist/types/index.d.ts",\n};\n'})}),"\n",(0,t.jsx)(n.p,{children:"预设字符串对应的构建配置："}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"export const buildConfig = [\n  {\n    format: 'cjs',\n    target: 'es6',\n    buildType: 'bundleless',\n    outDir: './dist/lib',\n  },\n  {\n    format: 'esm',\n    target: 'es6',\n    buildType: 'bundleless',\n    outDir: './dist/es',\n  },\n  {\n    buildType: 'bundleless',\n    outDir: './dist/types',\n    dts: {\n      only: true,\n    },\n  },\n];\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"npm-component-with-umd",children:[(0,t.jsx)(n.code,{children:"npm-component-with-umd"}),(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#npm-component-with-umd",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:["在类 ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer",children:"NPM"})," 包管理器下使用的组件（库），同时支持类 ",(0,t.jsx)(n.a,{href:"https://unpkg.com/",target:"_blank",rel:"noopener noreferrer",children:"unpkg"})," 的模式。 在预设 ",(0,t.jsx)(n.code,{children:"'npm-component'"})," 的基础上，额外提供 ",(0,t.jsx)(n.code,{children:"umd"})," 产物。"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",meta:'title="package.json"',children:'{\n    "main": "./dist/lib/index.js", // bundleless type\n    "module": "./dist/es/index.js", // bundleless type\n    "types": "./dist/types/index.d.ts",\n    "unpkg": "./dist/umd/index.js",\n};\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"export const buildConfig = [\n  {\n    format: 'cjs',\n    target: 'es6',\n    buildType: 'bundleless',\n    outDir: './dist/lib',\n  },\n  {\n    format: 'esm',\n    target: 'es6',\n    buildType: 'bundleless',\n    outDir: './dist/es',\n  },\n  {\n    format: 'umd',\n    target: 'es6',\n    platform: 'browser',\n    buildType: 'bundle',\n    outDir: './dist/umd',\n  },\n  {\n    buildType: 'bundleless',\n    outDir: './dist/types',\n    dts: {\n      only: true,\n    },\n  },\n];\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"npm-library-es5esnext",children:[(0,t.jsx)(n.code,{children:"npm-library-{es5...esnext}"}),(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#npm-library-es5esnext",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:["当想要使用支持其他 ECMAScript 版本的 ",(0,t.jsx)(n.code,{children:"buildPreset"})," 预设的时候，可以直接在 ",(0,t.jsx)(n.code,{children:"'npm-library'"}),"、",(0,t.jsx)(n.code,{children:"'npm-library-with-umd'"}),"、",(0,t.jsx)(n.code,{children:"'npm-component'"}),"、",(0,t.jsx)(n.code,{children:"'npm-component-with-umd'"})," 这些预设值后面增加想要支持的版本。"]}),"\n",(0,t.jsxs)(n.p,{children:["例如希望 ",(0,t.jsx)(n.code,{children:"'npm-library'"})," 预设支持 ",(0,t.jsx)(n.code,{children:"'es2017'"}),"，则可以按照如下方式配置："]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",meta:'title="modern.config.ts"',children:"import { defineConfig } from '@modern-js/module-tools';\n\nexport default defineConfig({\n  buildPreset: 'npm-library-es2017',\n});\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"string--function",children:["string / Function",(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#string--function",children:"#"})]}),"\n",(0,t.jsxs)(n.p,{children:["buildPreset 除了支持基本的字符串形式，还支持函数形式，可以通过 ",(0,t.jsx)(n.code,{children:"preset"})," 或者 ",(0,t.jsx)(n.code,{children:"extendPreset"})," 参数获取我们提供的预设值，然后进行修改。"]}),"\n",(0,t.jsxs)(n.p,{children:["以下是两个分别使用 ",(0,t.jsx)(n.code,{children:"preset"})," 和 ",(0,t.jsx)(n.code,{children:"extendPreset"})," 的例子："]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",meta:'title="modern.config.ts"',children:"import { defineConfig } from '@modern-js/module-tools';\n\nexport default defineConfig({\n  buildPreset({ preset }) {\n    const { NPM_LIBRARY } = preset;\n    return NPM_LIBRARY.map(config => {\n      config.define = {\n        VERSION: '1.0.1',\n      };\n      return config;\n    });\n  },\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"extendPreset"})," 里会使用 lodash.merge 进行配置合并"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",meta:'title="modern.config.ts"',children:"import { defineConfig } from '@modern-js/module-tools';\n\nexport default defineConfig({\n  buildPreset({ extendPreset }) {\n    return extendPreset('npm-library', {\n      define: {\n        VERSION: '1.0.1',\n      },\n    });\n  },\n});\n"})})]})}(s=globalThis).__RSPRESS_PAGE_META||(s.__RSPRESS_PAGE_META={}),globalThis.__RSPRESS_PAGE_META["zh%2Fapi%2Fconfig%2Fbuild-preset.mdx"]={toc:[{text:"npm-library",id:"npm-library",depth:2},{text:"npm-library-with-umd",id:"npm-library-with-umd",depth:2},{text:"npm-component",id:"npm-component",depth:2},{text:"npm-component-with-umd",id:"npm-component-with-umd",depth:2},{text:"npm-library-{es5...esnext}",id:"npm-library-es5esnext",depth:2},{text:"string / Function",id:"string--function",depth:2}],title:"buildPreset",frontmatter:{sidebar_position:2}};var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},(0,l.useMDXComponents)(),e.components).wrapper;return n?(0,t.jsx)(n,(0,i._)((0,d._)({},e),{children:(0,t.jsx)(o,(0,d._)({},e))})):o(e)}}}]);