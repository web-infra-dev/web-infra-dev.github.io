{"version":3,"file":"static/js/async/docs_zh_guides_topic-detail_generator_plugin_context_md.252973fd.js","sources":["./docs/zh/guides/topic-detail/generator/plugin/context.md"],"sourcesContent":["globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"zh%2Fguides%2Ftopic-detail%2Fgenerator%2Fplugin%2Fcontext.md\"] = {\"toc\":[{\"text\":\"自定义 Input\",\"id\":\"自定义-input\",\"depth\":2},{\"text\":\"生命周期\",\"id\":\"生命周期\",\"depth\":2},{\"text\":\"onForged\",\"id\":\"onforged\",\"depth\":2},{\"text\":\"afterForged\",\"id\":\"afterforged\",\"depth\":2}],\"title\":\"Context\",\"frontmatter\":{\"sidebar_position\":4}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        h1: \"h1\",\n        a: \"a\",\n        p: \"p\",\n        code: \"code\",\n        pre: \"pre\",\n        div: \"div\",\n        h2: \"h2\",\n        ul: \"ul\",\n        li: \"li\"\n    }, _provideComponents(), props.components);\n    return <><_components.h1 id=\"context\">{\"Context\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#context\">{\"#\"}</_components.a></_components.h1>{\"\\n\"}<_components.p>{\"生成器插件默认会导出一个函数，函数参数为 \"}<_components.code>{\"context\"}</_components.code>{\"，在执行过程中 \"}<_components.code>{\"context\"}</_components.code>{\" 会自动注入到生成器插件中。\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\" meta='title=\"src/index.ts\"'>{\"import { IPluginContext, ForgedAPI } from '@modern-js/generator-plugin';\\n\\nexport default function (context: IPluginContext) {\\n  context.onForged(async (_api: ForgedAPI, _input: Record<string, unknown>) => {\\n    /**\\n     * Todo\\n     */\\n  });\\n}\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p><_components.code>{\"context\"}</_components.code>{\" 提供了两类 API，分别用于自定义 Input 和定义生成器插件声明周期逻辑。\"}</_components.p>{\"\\n\"}<_components.div className=\"modern-directive info\"><_components.div className=\"modern-directive-title\">{\"INFO\"}</_components.div><_components.div className=\"modern-directive-content\"><_components.p>{\"下面只对部分 API 做简单示例讲解，完整的 API 请移步 \"}<_components.a href=\"/guides/topic-detail/generator/plugin/api/context\">{\"生成器插件 API\"}</_components.a>{\" 查看。\\n\"}</_components.p></_components.div></_components.div>{\"\\n\"}<_components.h2 id=\"自定义-input\">{\"自定义 Input\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#自定义-input\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"Modern.js Web 应用和 Npm 模块工程方案都存在一些默认的 Input 交互，使用这里的 API 可以对这些 Input 进行添加、修改、隐藏、提供默认值等操作。\"}</_components.p>{\"\\n\"}<_components.p>{\"例如：\"}</_components.p>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"添加问题\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"context.addInputBefore('packageManager', {\\n  type: 'object',\\n  properties: {\\n    'username': {\\n      type: 'string',\\n      title: '用户名',\\n    },\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"通过设置 config 隐藏问题\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"context.setDefaultConfig({ langauge: 'ts' });\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.h2 id=\"生命周期\">{\"生命周期\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#生命周期\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"生成器插件提供了两个生命周期钩子函数用于定义生成器插件行为：\"}</_components.p>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li>{\"\\n\"}<_components.p>{\"onForged：完成文件操作后的生命周期。\"}</_components.p>{\"\\n\"}</_components.li>{\"\\n\"}<_components.li>{\"\\n\"}<_components.p>{\"afterForged：onForged 钩子函数执行完成后的生命周期。\"}</_components.p>{\"\\n\"}</_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}<_components.h2 id=\"onforged\">{\"onForged\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#onforged\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"在 Modern.js 工程方案生成器完成文件操作之后的钩子函数，用于完成生成器插件中的文件操作，比如添加模板文件，覆盖现有文件，删除现有文件等。\"}</_components.p>{\"\\n\"}<_components.p>{\"对于扩展类型同时执行多个生成器插件时，将会按照声明顺序依次执行对应生成器插件的 \"}<_components.code>{\"onForged\"}</_components.code>{\" 操作。\"}</_components.p>{\"\\n\"}<_components.p><_components.code>{\"onForged\"}</_components.code>{\" 函数参数为一个回调函数，参数为 \"}<_components.code>{\"api\"}</_components.code>{\" 和 \"}<_components.code>{\"input\"}</_components.code>{\"。\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"context.onForged(async (api: ForgedAPI, input: Record<string, unknown>) => {\\n  const { language } = input;\\n  api.addFile({\\n      type: FileType.Text,\\n      file: `src/index.${language as string}`,\\n      templateFile: `index.${language as string}.handlebars`,\\n      force: true,\\n  });\\n})\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p><_components.code>{\"api\"}</_components.code>{\" 上会提供生成器插件支持的文件操作相关方法。\"}</_components.p>{\"\\n\"}<_components.p><_components.code>{\"input\"}</_components.code>{\" 为当前用户输入内容，包含 \"}<_components.code>{\"--config\"}</_components.code>{\" 参数定义的，默认工程方案交互的及生成器插件定义的用户输入。\"}</_components.p>{\"\\n\"}<_components.p>{\"当需要添加新的文件模板时，将模板文件定义到 \"}<_components.code>{\"templates\"}</_components.code>{\" 目录，然后通过上述 \"}<_components.code>{\"api\"}</_components.code>{\" 上方法进行操作即可，生成器插件默认对 \"}<_components.code>{\"templates\"}</_components.code>{\" 目录文件进行操作，无需再声明 \"}<_components.code>{\"templates\"}</_components.code>{\" 路径。\"}</_components.p>{\"\\n\"}<_components.h2 id=\"afterforged\">{\"afterForged\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#afterforged\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p><_components.code>{\"onForged\"}</_components.code>{\" 钩子函数执行完成后执行，这里主要用于进行安装依赖，Git 操作等。\"}</_components.p>{\"\\n\"}<_components.p>{\"默认 Modern.js 工程方案在完成文件操作后会默认执行安装依赖及 Git 初始化，Git 初次提交等，该钩子函数可以不使用。\"}</_components.p>{\"\\n\"}<_components.p>{\"对于自定义的生成器插件还支持 custom 类型，该类型只提供了少量最佳实践的项目配置，则需要在该钩子函数中完成安装依赖和 Git 初始化等操作。\"}</_components.p>{\"\\n\"}<_components.p><_components.code>{\"afterForged\"}</_components.code>{\" 函数参数也为一个回调函数，参数为 \"}<_components.code>{\"api\"}</_components.code>{\" 和 \"}<_components.code>{\"input\"}</_components.code>{\"。\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"  context.afterForged(\\n    async (api: AfterForgedAPI, input: Record<string, unknown>) => {\\n      const { packageManager } = input;\\n      console.info('packageManager:', packageManager);\\n      await api.install();\\n    },\\n  );\\n\"}</_components.code></_components.pre></>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","a","p","code","pre","div","h2","ul","li","components","id","className","href","meta","globalThis","__RSPRESS_PAGE_META","MDXLayout","wrapper","_"],"mappings":"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"}