{"version":3,"file":"static/js/async/docs_zh_tutorials_first-app_c05-loader_mdx.dd35a704.js","sources":["./docs/zh/tutorials/first-app/c05-loader.mdx"],"sourcesContent":["globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"zh%2Ftutorials%2Ffirst-app%2Fc05-loader.mdx\"] = {\"toc\":[],\"title\":\"添加 Loader\",\"frontmatter\":{\"title\":\"添加 Loader\"}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        h1: \"h1\",\n        a: \"a\",\n        p: \"p\",\n        strong: \"strong\",\n        code: \"code\",\n        pre: \"pre\",\n        div: \"div\",\n        img: \"img\"\n    }, _provideComponents(), props.components);\n    return <><_components.h1 id=\"添加-loader\">{\"添加 Loader\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#添加-loader\">{\"#\"}</_components.a></_components.h1>{\"\\n\"}<_components.p>{\"上一章节中，我们学习了如何添加客户端路由。\"}</_components.p>{\"\\n\"}<_components.p>{\"这一章节中，我们将会学习如何为\"}<_components.strong>{\"路由组件添加 Loader\"}</_components.strong>{\"。\"}</_components.p>{\"\\n\"}<_components.p>{\"到目前为止，我们都是通过硬编码的方式，为组件提供数据。如果要从远端获取数据，通常情况下会使用 \"}<_components.code>{\"useEffect\"}</_components.code>{\" 来做。但在启用 SSR 的情况下，\"}<_components.code>{\"useEffect\"}</_components.code>{\" 是不会在服务端执行的，所以这种 SSR 只能渲染很有限的 UI。\"}</_components.p>{\"\\n\"}<_components.p>{\"Modern.js 为提供了 Data Loader 的能力，支持同构的在组件中获取数据，让 SSR 的价值最大化。\"}</_components.p>{\"\\n\"}<_components.p>{\"下面我们演示如何为路由组件添加 Data Loader，并模拟远端数据获取。我们使用 faker 来 mock 需要的数据，首先安装依赖：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-bash\">{\"pnpm add faker@5\\npnpm add @types/faker@5 -D\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"创建 \"}<_components.code>{\"src/routes/page.loader.ts\"}</_components.code>{\"：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-tsx\">{\"import { name, internet } from 'faker';\\n\\ntype LoaderData = {\\n  code: number;\\n  data: {\\n    name: string;\\n    avatar: string;\\n    email: string;\\n  }[];\\n};\\n\\nexport default async (): Promise<LoaderData> => {\\n  const data = new Array(20).fill(0).map(() => {\\n    const firstName = name.firstName();\\n    return {\\n      name: firstName,\\n      avatar: `https://avatars.dicebear.com/api/identicon/${firstName}.svg`,\\n      email: internet.email(),\\n    };\\n  });\\n\\n  return {\\n    code: 200,\\n    data,\\n  };\\n};\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.div className=\"modern-directive note\"><_components.div className=\"modern-directive-title\">{\"NOTE\"}</_components.div><_components.div className=\"modern-directive-content\"><_components.p>{\"Data Loader 并非只为 SSR 工作。在 CSR 项目中，Data Loader 也可以避免数据获取依赖 UI 渲染，解决请求瀑布流的问题。未来，Modern.js 也会为这一特性添加更多能力，例如预获取、数据缓存等。\"}</_components.p>{\"\\n\"}</_components.div></_components.div>{\"\\n\"}<_components.p>{\"Modern.js 也提供了一个叫 \"}<_components.code>{\"useLoaderData\"}</_components.code>{\" 的 hooks API，我们修改 \"}<_components.code>{\"src/routes/page.tsx\"}</_components.code>{\" 导出的组件：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-tsx\" meta=\"{1,4,13}\">{\"import { useLoaderData } from '@modern-js/runtime/router';\\n\\nfunction Index() {\\n  const { data } = useLoaderData() as LoaderData;\\n\\n  return (\\n    <div className=\\\"container lg mx-auto\\\">\\n      <Helmet>\\n        <title>All</title>\\n      </Helmet>\\n      <List\\n        dataSource={data}\\n        renderItem={info => <Item key={info.name} info={info} />}\\n      />\\n    </div>\\n  );\\n}\\n\\nexport default Index;\\n\"}</_components.code></_components.pre>{\"\\n\"}{}{\"\\n\"}<_components.p>{\"重新执行 \"}<_components.code>{\"pnpm run dev\"}</_components.code>{\"，查看 \"}<_components.code>{\"view-source:http://localhost:8080/\"}</_components.code>{\"，或在 devtools 的 Network 面板里查看 HTML 请求的「 Preview 」，可以看到 SSR 渲染出来的 HTML 已经包含完整的 UI：\"}</_components.p>{\"\\n\"}<_components.p><_components.img src=\"https://lf3-static.bytednsdoc.com/obj/eden-cn/aphqeh7uhohpquloj/modern-js/docs/11/display6.png\" alt=\"display6\"/></_components.p></>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","a","p","strong","code","pre","div","img","components","id","className","href","meta","src","alt","globalThis","__RSPRESS_PAGE_META","MDXLayout","wrapper","_"],"mappings":"0NAAA,E,mDAGA,SAASA,EAAkBC,CAAK,EAC5B,IAAMC,EAAcC,OAAOC,MAAM,CAAC,CAC9BC,GAAI,KACJC,EAAG,IACHC,EAAG,IACHC,OAAQ,SACRC,KAAM,OACNC,IAAK,MACLC,IAAK,MACLC,IAAK,KACT,EAAG,yBAAsBX,EAAMY,UAAU,EACzC,MAAO,uB,UAAE,WAACX,EAAYG,EAAE,EAACS,GAAG,Y,UAAa,YAAY,UAACZ,EAAYI,CAAC,EAACS,UAAU,gBAAgB,cAAY,OAAOC,KAAK,a,SAAc,G,MAAsC,KAAK,UAACd,EAAYK,CAAC,E,SAAE,uB,GAAyC,KAAK,WAACL,EAAYK,CAAC,E,UAAE,kBAAkB,UAACL,EAAYM,MAAM,E,SAAE,e,GAAsC,I,GAAqB,KAAK,WAACN,EAAYK,CAAC,E,UAAE,kDAAkD,UAACL,EAAYO,IAAI,E,SAAE,W,GAAgC,qBAAqB,UAACP,EAAYO,IAAI,E,SAAE,W,GAAgC,oC,GAAqD,KAAK,UAACP,EAAYK,CAAC,E,SAAE,4D,GAA8E,KAAK,UAACL,EAAYK,CAAC,E,SAAE,uE,GAAyF,KAAK,UAACL,EAAYQ,GAAG,E,SAAC,UAACR,EAAYO,IAAI,EAACM,UAAU,gB,SAAiB,gD,KAAuF,KAAK,WAACb,EAAYK,CAAC,E,UAAE,MAAM,UAACL,EAAYO,IAAI,E,SAAE,2B,GAAgD,I,GAAqB,KAAK,UAACP,EAAYQ,GAAG,E,SAAC,UAACR,EAAYO,IAAI,EAACM,UAAU,e,SAAgB,4gB,KAAmjB,KAAK,WAACb,EAAYS,GAAG,EAACI,UAAU,wB,UAAwB,UAACb,EAAYS,GAAG,EAACI,UAAU,yB,SAA0B,M,GAAyB,WAACb,EAAYS,GAAG,EAACI,UAAU,2B,UAA2B,UAACb,EAAYK,CAAC,E,SAAE,oH,GAAsI,K,MAA0C,KAAK,WAACL,EAAYK,CAAC,E,UAAE,qBAAqB,UAACL,EAAYO,IAAI,E,SAAE,e,GAAoC,qBAAqB,UAACP,EAAYO,IAAI,E,SAAE,qB,GAA0C,U,GAA2B,KAAK,UAACP,EAAYQ,GAAG,E,SAAC,UAACR,EAAYO,IAAI,EAACM,UAAU,eAAeE,KAAK,W,SAAY,ma,KAA0c,KAAQ,KAAK,WAACf,EAAYK,CAAC,E,UAAE,QAAQ,UAACL,EAAYO,IAAI,E,SAAE,c,GAAmC,OAAO,UAACP,EAAYO,IAAI,E,SAAE,oC,GAAyD,mF,GAAoG,KAAK,UAACP,EAAYK,CAAC,E,SAAC,UAACL,EAAYU,GAAG,EAACM,IAAI,iGAAiGC,IAAI,U,OACnrG,CAfA,GAAAC,UAAA,EAAWC,mBAAmB,EAA9B,GAAWA,mBAAmB,CAAK,CAAC,GACpCD,WAAWC,mBAAmB,CAAC,8CAA8C,CAAG,CAAC,IAAM,EAAE,CAAC,MAAQ,YAAY,YAAc,CAAC,MAAQ,WAAW,CAAC,EAmBjJ,MAJA,W,IAAoBpB,EAAQ,UAAR,6CAAQ,CAAC,EACRqB,EAAc,AAAAnB,OAAOC,MAAM,CAAC,CAAC,EAAG,yBAAsBH,EAAMY,UAAU,EAA/EU,OAAO,CACf,OAAOD,EAAY,UAACA,EAAA,mBAAcrB,GAAA,C,SAAO,UAACD,EAAA,KAAAwB,CAAA,AAAAA,EAAA,GAAsBvB,G,IAAuBD,EAAkBC,EAC7G,C"}