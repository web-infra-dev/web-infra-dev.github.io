{"version":3,"file":"static/js/async/docs_zh_configure_app_bff_proxy_mdx.3416f4da.js","sources":["./docs/zh/components/bff-proxy-path-rewrite.mdx","./docs/zh/components/bff-proxy-principle.mdx","./docs/zh/configure/app/bff/proxy.mdx"],"sourcesContent":["globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"zh%2Fcomponents%2Fbff-proxy-path-rewrite.mdx\"] = {\"toc\":[],\"title\":\"\",\"frontmatter\":{}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        p: \"p\",\n        code: \"code\",\n        pre: \"pre\"\n    }, _provideComponents(), props.components);\n    return <><_components.p>{\"这里还可以进行路径重写，如将发送到 \"}<_components.code>{\"localhost:8080/api/topics\"}</_components.code>{\" 的请求代理到 \"}<_components.code>{\"https://cnodejs.org/api/v1/topics\"}</_components.code>{\"。\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\" meta='title=\"modern.server-runtime.config.ts\"'>{\"import { defineConfig } from '@modern-js/app-tools/server';\\nexport default defineConfig({\\n  bff: {\\n    proxy: {\\n      '/api': {\\n        target: 'https://cnodejs.org',\\n        pathRewrite: { '/api/topics': '/api/v1/topics' },\\n        changeOrigin: true,\\n      },\\n    },\\n  },\\n});\\n\"}</_components.code></_components.pre></>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n","globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"zh%2Fcomponents%2Fbff-proxy-principle.mdx\"] = {\"toc\":[],\"title\":\"\",\"frontmatter\":{}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        p: \"p\",\n        a: \"a\"\n    }, _provideComponents(), props.components);\n    return <_components.p>{\"BFF Proxy 使用了强大的 \"}<_components.a href=\"https://github.com/chimurai/http-proxy-middleware\" target=\"_blank\" rel=\"noopener noreferrer\">{\"http-proxy-middleware\"}</_components.a>{\"，如果需要更多高级的用法， 可以查看它的\"}<_components.a href=\"https://github.com/chimurai/http-proxy-middleware#options\" target=\"_blank\" rel=\"noopener noreferrer\">{\"文档\"}</_components.a>{\"。\"}</_components.p>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n","globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"zh%2Fconfigure%2Fapp%2Fbff%2Fproxy.mdx\"] = {\"toc\":[{\"text\":\"常见用法\",\"id\":\"常见用法\",\"depth\":2},{\"text\":\"解决接口跨域问题\",\"id\":\"解决接口跨域问题\",\"depth\":3}],\"title\":\"bff.proxy\",\"frontmatter\":{\"sidebar_label\":\"proxy\"}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nimport EnableBFFCaution from \"@site-docs/components/enable-bff-caution\";\nimport BFFProxyPathRewrite from \"@site-docs/components/bff-proxy-path-rewrite\";\nimport BFFProxyPrinciple from \"@site-docs/components/bff-proxy-principle\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        h1: \"h1\",\n        a: \"a\",\n        ul: \"ul\",\n        li: \"li\",\n        strong: \"strong\",\n        code: \"code\",\n        p: \"p\",\n        pre: \"pre\",\n        h2: \"h2\",\n        h3: \"h3\",\n        div: \"div\"\n    }, _provideComponents(), props.components);\n    return <><_components.h1 id=\"bffproxy\">{\"bff.proxy\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#bffproxy\">{\"#\"}</_components.a></_components.h1>{\"\\n\"}<_components.ul>{\"\\n\"}<_components.li><_components.strong>{\"类型：\"}</_components.strong>{\" \"}<_components.code>{\"Record<string, string>\"}</_components.code></_components.li>{\"\\n\"}<_components.li><_components.strong>{\"默认值：\"}</_components.strong>{\" \"}<_components.code>{\"{}\"}</_components.code></_components.li>{\"\\n\"}</_components.ul>{\"\\n\"}{\"\\n\"}<EnableBFFCaution/>{\"\\n\"}<_components.p>{\"通过简单配置，Modern.js 可以将发送给 BFF server 的请求，自动代理到指定的服务上。\"}</_components.p>{\"\\n\"}<_components.p>{\"在 \"}<_components.code>{\"modern.server-runtime.config.js\"}</_components.code>{\" 中加入以下配置；即可开启代理：\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-js\" meta='title=\"modern.server-runtime.config.js\"'>{\"import { defineConfig } from '@modern-js/app-tools/server';\\nexport default defineConfig({\\n  bff: {\\n    proxy: {\\n      '/api': 'https://cnodejs.org',\\n    },\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"假设 Modern.js BFF server 的地址是 \"}<_components.code>{\"localhost:8080\"}</_components.code>{\"，所有以 \"}<_components.code>{\"api\"}</_components.code>{\" 开头的请求都会被代理到 \"}<_components.code>{\"https://cnodejs.org\"}</_components.code>{\"，如 \"}<_components.code>{\"localhost:8080/api/v1/topics\"}</_components.code>{\" 的请求会被代理到 \"}<_components.code>{\"https://cnodejs.org/api/v1/topics\"}</_components.code>{\"。\"}</_components.p>{\"\\n\"}{\"\\n\"}<BFFProxyPathRewrite/>{\"\\n\"}<_components.p>{\"与 \"}<_components.a href=\"/configure/app/dev/proxy\">{\"dev.proxy\"}</_components.a>{\" 不同，本节所介绍的代理只作用于进入 BFF/API 服务的请求；同时，这一配置不但可以在开发环境中使用，在生产环境中也会代理相应的请求。\"}</_components.p>{\"\\n\"}{\"\\n\"}<BFFProxyPrinciple/>{\"\\n\"}<_components.h2 id=\"常见用法\">{\"常见用法\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#常见用法\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.h3 id=\"解决接口跨域问题\">{\"解决接口跨域问题\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#解决接口跨域问题\">{\"#\"}</_components.a></_components.h3>{\"\\n\"}<_components.p>{\"在项目开发过程中，因为 web 页面和接口服务不是部署在同一个域名下，常常会遇到跨域问题。\\n解决跨域问题的方式有很多，在这里我们使用 \"}<_components.code>{\"bff.proxy\"}</_components.code>{\" 可以轻松解决跨域问题。\"}</_components.p>{\"\\n\"}<_components.div className=\"modern-directive info\"><_components.div className=\"modern-directive-title\">{\"INFO\"}</_components.div><_components.div className=\"modern-directive-content\"><_components.p>{\"BFF proxy 模式下，如果不需要写 BFF 的接口， API 目录可以删除；此时 BFF proxy 仍会开启。\"}</_components.p>{\"\\n\"}</_components.div></_components.div>{\"\\n\"}<_components.p>{\"如下所示，在 \"}<_components.code>{\"modern.server-runtime.config.ts\"}</_components.code>{\" 中，写入如下配置；我们将所有 web 页面发送到同域的以 \"}<_components.code>{\"/api\"}</_components.code>{\" 开头的请求代理到另一个域名的服务上。\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\" meta='title=\"modern.server-runtime.config.ts\"'>{\"export default defineServerConfig({\\n  bff: {\\n    proxy: {\\n      '/api': 'https://cnodejs.org',\\n    },\\n  },\\n};\\n\"}</_components.code></_components.pre></>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n"],"names":["_createMdxContent","props","_components","Object","assign","p","code","pre","components","className","meta","globalThis","__RSPRESS_PAGE_META","MDXLayout","wrapper","_","a","href","target","rel","h1","ul","li","strong","h2","h3","div","id"],"mappings":"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"}