{"version":3,"file":"static/js/async/docs_en_guides_topic-detail_model_performance_mdx.48a5b206.js","sources":["./docs/en/guides/topic-detail/model/performance.mdx"],"sourcesContent":["globalThis.__RSPRESS_PAGE_META ||= {};\nglobalThis.__RSPRESS_PAGE_META[\"en%2Fguides%2Ftopic-detail%2Fmodel%2Fperformance.mdx\"] = {\"toc\":[{\"text\":\"Splitting Models\",\"id\":\"splitting-models\",\"depth\":2},{\"text\":\"State Selection\",\"id\":\"state-selection\",\"depth\":2},{\"text\":\"Derivative State Caching\",\"id\":\"derivative-state-caching\",\"depth\":2}],\"title\":\"Performance Optimization\",\"frontmatter\":{\"sidebar_position\":8,\"title\":\"Performance Optimization\"}};\nimport { useMDXComponents as _provideComponents } from \"@mdx-js/react\";\nfunction _createMdxContent(props) {\n    const _components = Object.assign({\n        h1: \"h1\",\n        a: \"a\",\n        p: \"p\",\n        h2: \"h2\",\n        code: \"code\",\n        pre: \"pre\",\n        div: \"div\"\n    }, _provideComponents(), props.components);\n    return <><_components.h1 id=\"performance-optimization\">{\"Performance Optimization\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#performance-optimization\">{\"#\"}</_components.a></_components.h1>{\"\\n\"}<_components.p>{\"Reduck has already done a lot of performance optimization work internally, so performance issues generally do not need to be considered. However, when performance is more sensitive, or when encountering performance issues, you can consider more targeted performance optimization from the following three aspects.\"}</_components.p>{\"\\n\"}<_components.h2 id=\"splitting-models\">{\"Splitting Models\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#splitting-models\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"When \"}<_components.code>{\"useModel\"}</_components.code>{\" returns the complete State object of the Model, any change in any part of the State will cause the component that calls \"}<_components.code>{\"useModel\"}</_components.code>{\" to be re-rendered.\"}</_components.p>{\"\\n\"}<_components.p>{\"For example:\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"const fooModel = model('foo').define({\\n  state: {\\n    a: '',\\n    b: '',\\n  },\\n  actions: {\\n    setA(state, payload) {\\n      state.a = payload;\\n    },\\n    setB(state, payload) {\\n      state.b = payload;\\n    },\\n  },\\n});\\n\\nfunction ComponentA() {\\n  const [state] = useModel(fooModel);\\n\\n  return <div>{state.a}</div>;\\n}\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"Although \"}<_components.code>{\"ComponentA\"}</_components.code>{\" only needs to use the \"}<_components.code>{\"a\"}</_components.code>{\" state, it will still be re-rendered when the \"}<_components.code>{\"b\"}</_components.code>{\" state changes. In this case, we can consider splitting \"}<_components.code>{\"fooModel\"}</_components.code>{\" into separate Models responsible for managing \"}<_components.code>{\"a\"}</_components.code>{\" and \"}<_components.code>{\"b\"}</_components.code>{\" respectively:\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"const fooModel = model('foo').define({\\n  state: {\\n    a: '',\\n  },\\n  actions: {\\n    setA(state, payload) {\\n      state.a = payload;\\n    },\\n  },\\n});\\n\\nconst barModel = model('bar').define({\\n  state: {\\n    b: '',\\n  },\\n  actions: {\\n    setB(state, payload) {\\n      state.b = payload;\\n    },\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.h2 id=\"state-selection\">{\"State Selection\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#state-selection\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p><_components.code>{\"useModel\"}</_components.code>{\" supports passing in a selector function to filter the returned State and Actions for the component. We can use a selector function to ensure that the State returned to the component is what the component needs directly, thus ensuring that the component is not re-rendered due to changes in other unrelated states.\"}</_components.p>{\"\\n\"}<_components.p>{\"For the same example above, we can use a selector function for performance optimization, the code is as follows:\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"const fooModel = model('foo').define({\\n  state: {\\n    a: '',\\n    b: '',\\n  },\\n  actions: {\\n    setA(state, payload) {\\n      state.a = payload;\\n    },\\n    setB(state, payload) {\\n      state.b = payload;\\n    },\\n  },\\n});\\n\\nfunction ComponentA() {\\n  // By passing in the selector function\\n  // only the a state is returned to the component\\n  const [stateA] = useModel(fooModel, state => state.a);\\n\\n  return <div>{stateA}</div>;\\n}\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.h2 id=\"derivative-state-caching\">{\"Derivative State Caching\"}<_components.a className=\"header-anchor\" aria-hidden=\"true\" href=\"#derivative-state-caching\">{\"#\"}</_components.a></_components.h2>{\"\\n\"}<_components.p>{\"When a Model has \"}<_components.code>{\"computed\"}</_components.code>{\" property, the \"}<_components.code>{\"computed\"}</_components.code>{\" function will be executed every time \"}<_components.code>{\"useModel\"}</_components.code>{\" is called.\"}</_components.p>{\"\\n\"}<_components.p>{\"Consider the following code:\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"const barModel = model('bar').define({\\n  state: {\\n    value: 'bar',\\n  },\\n  computed: {\\n    combineA: [\\n      fooModel, // fooModel define as above\\n      (state, fooState) => {\\n        return state + fooState.a;\\n      },\\n    ],\\n  },\\n  actions: {\\n    setValue(state, payload) {\\n      state.value = payload;\\n    },\\n  },\\n});\\n\\nfunction ComponentB() {\\n  const [state, actions] = useModel(fooModel);\\n  const [{ combineA }] = useModel(barModel);\\n  // ...\\n}\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"Even if the \"}<_components.code>{\"b\"}</_components.code>{\" state of \"}<_components.code>{\"fooModel\"}</_components.code>{\" changes, the \"}<_components.code>{\"combineA\"}</_components.code>{\" function (more precisely, the last function type element of \"}<_components.code>{\"combineA\"}</_components.code>{\") will still be called and executed when the component is re-rendered, although the derivative state \"}<_components.code>{\"combineA\"}</_components.code>{\" of \"}<_components.code>{\"barModel\"}</_components.code>{\" depends on \"}<_components.code>{\"barModel\"}</_components.code>{\" itself and the state \"}<_components.code>{\"a\"}</_components.code>{\" of \"}<_components.code>{\"fooModel\"}</_components.code>{\".\"}</_components.p>{\"\\n\"}<_components.p>{\"In general, the logic in the \"}<_components.code>{\"computed\"}</_components.code>{\" function is usually very lightweight, but when the logic in the \"}<_components.code>{\"computed\"}</_components.code>{\" function is relatively complex, we can consider caching the calculation logic. For example, we can use \"}<_components.a href=\"https://github.com/reduxjs/reselect\" target=\"_blank\" rel=\"noopener noreferrer\">{\"reselect\"}</_components.a>{\" to cache \"}<_components.code>{\"combineA\"}</_components.code>{\" of \"}<_components.code>{\"barModel\"}</_components.code>{\":\"}</_components.p>{\"\\n\"}<_components.pre><_components.code className=\"language-ts\">{\"import 'createSelector' from 'reselect';\\n\\n// create cache function\\nconst selectCombineA = createSelector(\\n  (state) => state.bar.value,\\n  (state) => state.foo.a,\\n  (barState, fooState) => {\\n    return barState + fooState;\\n  }\\n);\\n\\nconst barModel = model(\\\"bar\\\").define({\\n  state: {\\n    value: \\\"bar\\\",\\n  },\\n  computed: {\\n    combineA: [\\n      fooModel,\\n      (state, fooState) => {\\n        return selectCombineA({\\n          foo: fooState,\\n          bar: state,\\n        });\\n      },\\n    ],\\n  },\\n  actions: {\\n    setValue(state, payload) {\\n      state.value = payload;\\n    },\\n  },\\n});\\n\"}</_components.code></_components.pre>{\"\\n\"}<_components.p>{\"We created a caching function \"}<_components.code>{\"createSelector\"}</_components.code>{\", which only recalculates the value of \"}<_components.code>{\"combineA\"}</_components.code>{\" when the state of \"}<_components.code>{\"barModel\"}</_components.code>{\" changes or the state \"}<_components.code>{\"a\"}</_components.code>{\" of \"}<_components.code>{\"fooModel\"}</_components.code>{\" changes.\"}</_components.p>{\"\\n\"}<_components.div className=\"modern-directive info\"><_components.div className=\"modern-directive-title\">{\"Additional Information\"}</_components.div><_components.div className=\"modern-directive-content\"><_components.p>{\"You can find the complete example code of this section \"}<_components.a href=\"https://github.com/web-infra-dev/modern-js-examples/tree/main/examples/runtime-api/performance-optimization\" target=\"_blank\" rel=\"noopener noreferrer\">{\"here\"}</_components.a>{\".\\n\"}</_components.p></_components.div></_components.div></>;\n}\nfunction MDXContent(props = {}) {\n    const { wrapper: MDXLayout } = Object.assign({}, _provideComponents(), props.components);\n    return MDXLayout ? <MDXLayout {...props}><_createMdxContent {...props}/></MDXLayout> : _createMdxContent(props);\n}\nexport default MDXContent;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","a","p","h2","code","pre","div","components","id","className","href","target","rel","globalThis","__RSPRESS_PAGE_META","MDXLayout","wrapper","_"],"mappings":"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"}