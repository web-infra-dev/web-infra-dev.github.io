(self.webpackChunk_modern_js_main_doc=self.webpackChunk_modern_js_main_doc||[]).push([["docs_zh_guides_advanced-features_compatibility_mdx"],{93212:function(e,l,r){"use strict";r.r(l),r.d(l,{default:function(){return t}});var s,n=r("15169"),i=r("43932"),d=r("9880"),o=r("23169");function c(e){var l=Object.assign({h3:"h3",a:"a",p:"p",ul:"ul",li:"li",pre:"pre",code:"code",img:"img",div:"div"},(0,o.useMDXComponents)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(l.h3,{id:"运行时按需-polyfill",children:["运行时按需 Polyfill",(0,d.jsx)(l.a,{className:"header-anchor","aria-hidden":"true",href:"#运行时按需-polyfill",children:"#"})]}),"\n",(0,d.jsxs)(l.p,{children:["Modern.js 中还提供了基于浏览器 ",(0,d.jsx)(l.a,{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/User-Agent",target:"_blank",rel:"noopener noreferrer",children:"UA"})," 信息的运行时按需 Polyfill 方案，相比于 Babel 优势如下："]}),"\n",(0,d.jsxs)(l.ul,{children:["\n",(0,d.jsx)(l.li,{children:"不会插入到代码中，只根据访问页面的设备，按需下发 Polyfill 代码 ，减少整体代码体积。"}),"\n",(0,d.jsx)(l.li,{children:"相同浏览器会公用一份 Polyfill 代码。因此，随着项目越来越多，基于 UA 的 Polyfill 代码下发速度会越来越快，综合速度超过常规方案。"}),"\n"]}),"\n",(0,d.jsx)(l.p,{children:"可以通过微生成器开启该功能："}),"\n",(0,d.jsx)(l.pre,{children:(0,d.jsx)(l.code,{className:"language-bash",children:"? 请选择你想要的操作 启用可选功能\n? 请选择功能名称 启用「基于 UA 的 Polyfill」功能\n"})}),"\n",(0,d.jsxs)(l.p,{children:["执行命令后，在 ",(0,d.jsx)(l.code,{children:"modern.config.ts"})," 中注册 Polyfill 插件:"]}),"\n",(0,d.jsx)(l.pre,{children:(0,d.jsx)(l.code,{className:"language-ts",meta:'title="modern.config.ts"',children:"import { polyfillPlugin } from '@modern-js/plugin-polyfill';\n\nexport default defineConfig({\n  plugins: [..., polyfillPlugin()],\n});\n"})}),"\n",(0,d.jsxs)(l.p,{children:["配置 ",(0,d.jsx)(l.code,{children:"output.polyfill"})," 为 ",(0,d.jsx)(l.code,{children:"ua"})," 并且执行 ",(0,d.jsx)(l.code,{children:"pnpm run build && pnpm run serve"})," 启动服务器后，访问页面可以看到 HTML 产物中包含如下脚本:"]}),"\n",(0,d.jsx)(l.pre,{children:(0,d.jsx)(l.code,{className:"language-js",children:'<script src="/__polyfill__" crossorigin></script>\n'})}),"\n",(0,d.jsxs)(l.p,{children:["在 Chrome 51 下访问页面可以看到 ",(0,d.jsx)(l.code,{children:"http://localhost:8080/__polyfill__"})," 返回内容如下:"]}),"\n",(0,d.jsx)(l.p,{children:(0,d.jsx)(l.img,{src:"https://lf3-static.bytednsdoc.com/obj/eden-cn/aphqeh7uhohpquloj/modern-js/docs/ua-polyfill.png",alt:"ua-polyfill"})}),"\n",(0,d.jsxs)(l.div,{className:"modern-directive caution",children:[(0,d.jsx)(l.div,{className:"modern-directive-title",children:"注意"}),(0,d.jsxs)(l.div,{className:"modern-directive-content",children:[(0,d.jsx)(l.p,{children:"该功能只有在使用 Modern.js 内置的 Web Server 时才会生效。"}),"\n",(0,d.jsxs)(l.p,{children:["如果有自定义模版的需求，请参考 ",(0,d.jsx)(l.a,{href:"/guides/basic-features/html",children:"HTML 模板"}),"。通过 ",(0,d.jsx)(l.code,{children:"html.template"})," 或 ",(0,d.jsx)(l.code,{children:"tools.html"})," 手动修改模版时，可能会导致该功能无法正确生效。\n"]})]})]})]})}(s=globalThis).__RSPRESS_PAGE_META||(s.__RSPRESS_PAGE_META={}),globalThis.__RSPRESS_PAGE_META["zh%2Fcomponents%2Fua-polyfill.mdx"]={toc:[{text:"运行时按需 Polyfill",id:"运行时按需-polyfill",depth:3}],title:"",frontmatter:{}};var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=Object.assign({},(0,o.useMDXComponents)(),e.components).wrapper;return l?(0,d.jsx)(l,(0,i._)((0,n._)({},e),{children:(0,d.jsx)(c,(0,n._)({},e))})):c(e)}},66192:function(e,l,r){"use strict";r.r(l),r.d(l,{default:function(){return a}});var s,n=r("15169"),i=r("43932"),d=r("9880"),o=r("23169"),c=r("93212");function t(e){var l=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",code:"code",pre:"pre",div:"div",h3:"h3"},(0,o.useMDXComponents)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(l.h1,{id:"浏览器兼容性",children:["浏览器兼容性",(0,d.jsx)(l.a,{className:"header-anchor","aria-hidden":"true",href:"#浏览器兼容性",children:"#"})]}),"\n",(0,d.jsxs)(l.h2,{id:"browserslist-配置",children:["Browserslist 配置",(0,d.jsx)(l.a,{className:"header-anchor","aria-hidden":"true",href:"#browserslist-配置",children:"#"})]}),"\n",(0,d.jsxs)(l.p,{children:["Modern.js 支持设置 Web 应用需要兼容的浏览器范围，你可以在 ",(0,d.jsx)(l.code,{children:".browserslistrc"})," 文件里设置 ",(0,d.jsx)(l.a,{href:"https://browsersl.ist/",target:"_blank",rel:"noopener noreferrer",children:"Browserslist"})," 的值。"]}),"\n",(0,d.jsxs)(l.p,{children:["当你创建一个新的 Modern.js 项目时，默认会包含一份 ",(0,d.jsx)(l.code,{children:".browserslistrc"})," 配置，这表示 JavaScript 代码会被编译至 ES6 格式。"]}),"\n",(0,d.jsx)(l.pre,{children:(0,d.jsx)(l.code,{className:"language-yaml",meta:'title=".browserslistrc"',children:"chrome >= 51\nedge >= 15\nfirefox >= 54\nsafari >= 10\nios_saf >= 10\n"})}),"\n",(0,d.jsxs)(l.div,{className:"modern-directive tip",children:[(0,d.jsx)(l.div,{className:"modern-directive-title",children:"TIP"}),(0,d.jsx)(l.div,{className:"modern-directive-content",children:(0,d.jsxs)(l.p,{children:["请查看 ",(0,d.jsx)(l.a,{href:"https://modernjs.dev/builder/guide/advanced/browserslist",target:"_blank",rel:"noopener noreferrer",children:"Modern.js Builder - 设置浏览器范围"})," 来了解更多内容。\n"]})})]}),"\n",(0,d.jsxs)(l.h2,{id:"polyfill",children:["Polyfill",(0,d.jsx)(l.a,{className:"header-anchor","aria-hidden":"true",href:"#polyfill",children:"#"})]}),"\n",(0,d.jsxs)(l.h3,{id:"编译时-polyfill",children:["编译时 Polyfill",(0,d.jsx)(l.a,{className:"header-anchor","aria-hidden":"true",href:"#编译时-polyfill",children:"#"})]}),"\n",(0,d.jsxs)(l.p,{children:["Modern.js 在编译时默认通过 ",(0,d.jsx)(l.a,{href:"https://github.com/zloirock/core-js",target:"_blank",rel:"noopener noreferrer",children:"core-js"})," 引入对应的 Polyfill 代码。"]}),"\n",(0,d.jsx)(l.p,{children:"默认情况下会根据项目 Browserslist 的设置情况引入所需的 Polyfill 代码， 这样基本不用再担心项目源码和第三方依赖的 Polyfill 问题了，但是因为包含了一些没有用到的 Polyfill 代码，所以最终的包大小可能会有所增加。"}),"\n",(0,d.jsxs)(l.div,{className:"modern-directive info",children:[(0,d.jsx)(l.div,{className:"modern-directive-title",children:"INFO"}),(0,d.jsxs)(l.div,{className:"modern-directive-content",children:[(0,d.jsxs)(l.p,{children:["对于明确第三方依赖不需要 Polyfill 的场景，可以设置 ",(0,d.jsx)(l.a,{href:"/configure/app/output/polyfill",children:(0,d.jsx)(l.code,{children:"output.polyfill"})})," 为 ",(0,d.jsx)(l.code,{children:"usage"}),", 这样 Babel 编译时只会根据代码中使用到的语法引入 Polyfill 代码。"]}),"\n"]})]}),"\n","\n",(0,d.jsx)(c.default,{})]})}(s=globalThis).__RSPRESS_PAGE_META||(s.__RSPRESS_PAGE_META={}),globalThis.__RSPRESS_PAGE_META["zh%2Fguides%2Fadvanced-features%2Fcompatibility.mdx"]={toc:[{text:"Browserslist 配置",id:"browserslist-配置",depth:2},{text:"Polyfill",id:"polyfill",depth:2},{text:"编译时 Polyfill",id:"编译时-polyfill",depth:3}],title:"浏览器兼容性",frontmatter:{sidebar_position:6}};var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=Object.assign({},(0,o.useMDXComponents)(),e.components).wrapper;return l?(0,d.jsx)(l,(0,i._)((0,n._)({},e),{children:(0,d.jsx)(t,(0,n._)({},e))})):t(e)}}}]);